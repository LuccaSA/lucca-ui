/*! lucca-ui 09-09-2015 */
!function(){"use strict";angular.module("moment",[]).factory("moment",function(){return window.moment}),angular.module("lui.directives",[]),angular.module("lui.filters",["moment"]),angular.module("lui.services",["cgNotify"]),angular.module("lui.templates.momentpicker",[]),angular.module("lui.templates",["lui.templates.momentpicker"]),angular.module("lui",["lui.directives","lui.services","lui.filters","lui.templates"])}(),function(){"use strict";var a=function(a,b){var c=moment(a);return c.isValid()?c.format(b):a};angular.module("lui.filters").filter("luifFriendlyRange",function(){var a={en:{sameDay:"start(LL)",sameMonth:"start(MMMM Do) - end(Do, YYYY)",sameYear:"start(MMMM Do) - end(LL)",other:"start(LL) - end(LL)"},fr:{sameDay:"le start(LL)",sameMonth:"du start(Do) au end(LL)",sameYear:"du start(Do MMMM) au end(LL)",other:"du start(LL) au end(LL)"}},b={en:{sameDay:"start(MMMM Do)",sameMonth:"start(MMMM Do) - end(Do)",sameYear:"start(MMMM Do) - end(MMMM Do)",other:"start(LL) - end(LL)"},fr:{sameDay:"le start(Do MMMM)",sameMonth:"du start(Do) au end(Do MMMM)",sameYear:"du start(Do MMMM) au end(Do MMMM)",other:"du start(LL) au end(LL)"}};return function(c,d){if(c){var e=moment(c.startsAt||c.startsOn||c.startDate||c.start),f=moment(c.endsAt||c.endsOn||c.endDate||c.end);d&&f.add(-1,"d");var g=a[moment.locale()]||a.en;moment().year()===e.year()&&moment().year()===f.year()&&(g=b[moment.locale()]||b.en);var h=e.year()===f.year()?e.month()===f.month()?e.date()===f.date()?"sameDay":"sameMonth":"sameYear":"other",i=/(start\((.*?)\))(.*(end\((.*?)\))){0,1}/gi.exec(g[h]);return g[h].replace(i[1],e.format(i[2])).replace(i[4],f.format(i[5]))}}}).filter("luifMoment",function(){return function(b,c){return c||(c="LLL"),a(b,c)}}).filter("luifCalendar",function(){return function(a,b){var c=moment(a);b&&moment(b).isValid()?moment(b):moment();return c.isValid()?c.calendar(b):a}}).filter("luifDuration",function(){return function(b,c,d){var e=moment.duration(b),f=Math.floor(e.asHours()),g=e.minutes(),h="";return d&&(e.asMilliseconds()>0?h="+":e.asMilliseconds()<0&&(h="-")),c?h+a(moment(f+":"+g+":00","H:mm:ss"),c):f&&g?h+Math.abs(f)+"h"+a(moment(g,"m"),"mm"):g?h+Math.abs(g)+"m":f?h+Math.abs(f)+"h":""}}).filter("luifHumanize",function(){return function(a,b,c){b=!!b,c=!!c;var d=moment.duration(a);return c&&(d=moment.duration(-d.asMilliseconds())),d.humanize(b)}})}(),function(){"use strict";function a(a,b,c){function d(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}return a?a.replace(new RegExp(d(b),"g"),c):""}angular.module("lui.filters").filter("luifPlaceholder",function(){return function(a,b){return a?a:b}}).filter("luifDefaultCode",function(){return function(b){return a(b," ","_").toUpperCase()}}).filter("luifStartFrom",function(){return function(a,b){return b=+b,a.slice(b)}})}(),function(){"use strict";angular.module("lui.directives").directive("luidUserSelect",[function(){return{require:"^ngModel",scope:{users:"=",placeholder:"@",onSelect:"&",onRemove:"&"},restrict:"E",template:'<ui-select theme="bootstrap" on-select="onSelect()" on-remove="onRemove()">	<ui-select-match placeholder="{{placeholder}}">{{$select.selected.displayName}}</ui-select-match>	<ui-select-choices repeat="user in users | filter: $select.search">		<div ng-bind-html="user.displayName"></div>	</ui-select-choices></ui-select>'}}])}(),function(){"use strict";angular.module("lui.directives").directive("luidMoment",["moment",function(a){function b(b,c,d,e){var f=e[1],g=e[0];if(b.hasButtons=void 0!==d.showButtons,d.format){var h=b.$eval(d.format);f.$render=function(){if(this.$viewValue&&a(this.$viewValue,h).isValid()){var c=a(this.$viewValue,h);b.hours=c.format("HH"),b.mins=c.format("mm")}},f.setValue=function(a){a?f.$setViewValue(a.format(h)):f.$setViewValue(void 0)}}else f.$render=function(){this.$viewValue&&this.$viewValue.isValid()&&(b.hours=this.$viewValue.format("HH"),b.mins=this.$viewValue.format("mm"))},f.setValue=function(a){f.$setViewValue(a)};b.ngModelCtrl=f,f.$viewChangeListeners.push(function(){b.$eval(d.ngChange)}),f.$validators.min=function(a,b){return g.checkMin(a)},f.$validators.max=function(a,b){return g.checkMax(a)};var i=c.find("input"),j=angular.element(i[0]),k=angular.element(i[1]);g.setupEvents(j,k)}return{require:["luidMoment","^ngModel"],controller:"luidMomentController",replace:!0,scope:{min:"=",max:"=",step:"=",referenceDate:"=",disabled:"=",showButtons:"=",enforceValid:"=",format:"=",minOffset:"=",maxOffset:"="},templateUrl:"lui/directives/luidMoment.html",restrict:"EA",link:b}}]).controller("luidMomentController",["$scope","$timeout","moment",function(a,b,c){a.pattern=/^([0-9]{0,2})?$/;var d=[5,10,15,20,30],e=this,f=function(a,b){var c=!1;return angular.forEach(a,function(a){c=c||a===b}),c},g=function(b){if(!a.disabled){j(),a.ngModelCtrl.$setValidity("pattern",!0);var g=c(t());g||(g=q().startOf("day")),f(d,Math.abs(b))&&g.minutes()%b!==0&&(b=0>b?-(g.minutes()%b):-g.minutes()%b+b);var i=g.add(b,"m");e.checkMin(i)?e.checkMax(i)||(a.maxed=!0,i=s()):(a.mined=!0,i=r()),i.seconds(0),h(i)}},h=function(b){a.ngModelCtrl.setValue(b),a.ngModelCtrl.$render()},i=function(b){j(b),a.ngModelCtrl.setValue(b)},j=function(b){a.maxed=!1,a.mined=!1,b&&(r()&&0===r().diff(b)?a.mined=!0:s()&&0===s().diff(b)&&(a.maxed=!0))};a.changeHours=function(){return void 0===a.hours?(a.ngModelCtrl.$setValidity("pattern",!1),h(void 0)):(a.ngModelCtrl.$setValidity("pattern",!0),""===a.hours?h(void 0):(2==a.hours.length?(parseInt(a.hours)>23&&(a.hours="23"),a.$broadcast("focusMinutes")):1==a.hours.length&&parseInt(a.hours)>2&&(a.hours=0+a.hours,a.$broadcast("focusMinutes")),void i(k())))},a.changeMins=function(){return void 0===a.mins?(a.ngModelCtrl.$setValidity("pattern",!1),h(void 0)):(a.ngModelCtrl.$setValidity("pattern",!0),void i(k()))};var k=function(){var b=parseInt(a.hours),c=parseInt(a.mins);return b!=b&&(b=0),c!=c&&(c=0),q().hours(b).minutes(c).seconds(0)};a.formatInputValue=function(){a.ngModelCtrl.$render()},a.getDayGap=function(){var a=q().startOf("day");return c.duration(c(t()).startOf("d").diff(a)).asDays()},a.incrHours=function(){n(),g(60),a.$broadcast("focusHours")},a.decrHours=function(){n(),g(-60),a.$broadcast("focusHours")},a.incrMins=function(){n(),a.$broadcast("focusMinutes"),g(p())},a.decrMins=function(){n(),a.$broadcast("focusMinutes"),g(-p())};var l,m;a.blurHours=function(){l=b(function(){a.hoursFocused=!1,o()},200)},a.blurMins=function(){m=b(function(){a.minsFocused=!1,o()},200)},a.focusHours=function(){n(),a.minsFocused=!1,a.hoursFocused=!0},a.focusMins=function(){n(),a.minsFocused=!0,a.hoursFocused=!1};var n=function(){l&&(b.cancel(l),l=void 0),m&&(b.cancel(m),m=void 0)},o=function(){a.enforceValid&&(a.ngModelCtrl.$setValidity("pattern",!0),a.ngModelCtrl.$error.min?h(r()):a.ngModelCtrl.$error.max&&h(s()))},p=function(){var b=5;return isNaN(parseInt(a.step))||(b=parseInt(a.step)),b},q=function(){var b=c();return a.referenceDate&&c(a.referenceDate).isValid()?b=c(a.referenceDate):a.min&&c(a.min).isValid()?b=c(a.min):a.max&&c(a.max).isValid()&&(b=c(a.max)),b},r=function(){var b,d;if(!a.min)return void 0;if(a.min.isValid&&a.min.isValid())b=c(a.min);else if(c(a.min,"YYYY-MM-DD HH:mm").isValid())b=c(a.min,"YYYY-MM-DD HH:mm");else if(c(a.min,"HH:mm").isValid()){var e=q();b=c(a.min,"HH:mm").year(e.year()).month(e.month()).date(e.date())}return d=c.duration(a.minOffset),b.add(d),b},s=function(){var b,d;if(!a.max)return void 0;if(a.max.isValid&&a.max.isValid())b=c(a.max);else if(c(a.max,"YYYY-MM-DD HH:mm").isValid())b=c(a.max,"YYYY-MM-DD HH:mm");else if(c(a.max,"HH:mm").isValid()){var e=q();b=c(a.max,"HH:mm").year(e.year()).month(e.month()).date(e.date()),b.hours()+b.minutes()===0&&b.add(1,"d")}return d=c.duration(a.maxOffset),b.add(d),b},t=function(){return a.format?c(a.ngModelCtrl.$viewValue,a.format):a.ngModelCtrl.$viewValue};this.checkMin=function(a){var b=r();return!b||b.diff(a)<=0},this.checkMax=function(a){var b=s();return!b||b.diff(a)>=0},this.setupEvents=function(a,b){u(a,b),v(a,b)};var u=function(b,c){var d=p();b.bind("keydown",function(b){38===b.which?(b.preventDefault(),g(60),a.$apply()):40===b.which?(b.preventDefault(),g(-60),a.$apply()):13===b.which&&(b.preventDefault(),a.formatInputValue(),a.$apply())}),c.bind("keydown",function(b){38===b.which?(b.preventDefault(),g(d),a.$apply()):40===b.which?(b.preventDefault(),g(-d),a.$apply()):13===b.which&&(b.preventDefault(),a.formatInputValue(),a.$apply())})},v=function(b,c){var d=p(),e=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.disabled||(a.$apply(g(e(b)?60:-60)),b.preventDefault())}),c.bind("mousewheel wheel",function(b){a.disabled||(a.$apply(g(e(b)?d:-d)),b.preventDefault())})}}]),angular.module("lui.templates.momentpicker").run(["$templateCache",function(a){a.put("lui/directives/luidMoment.html","<div class='luid-moment' ng-class='{disabled:disabled}'>	<input type='text' ng-model='hours' ng-change='changeHours()' luid-select-on-click ng-pattern='pattern' luid-focus-on='focusHours'   ng-focus='focusHours()' ng-blur='blurHours()' ng-disabled='disabled' maxlength=2>:	<input type='text' ng-model='mins'  ng-change='changeMins()'  luid-select-on-click ng-pattern='pattern' luid-focus-on='focusMinutes' ng-focus='focusMins()'  ng-blur='blurMins()'  ng-disabled='disabled' maxlength=2>	<i ng-if='hasButtons' ng-click='incrHours()' ng-show='showButtons||hoursFocused||minsFocused' class='lui mp-button top left plus icon'      ng-class='{disabled:maxed}'></i>	<i ng-if='hasButtons' ng-click='decrHours()' ng-show='showButtons||hoursFocused||minsFocused' class='lui mp-button bottom left minus icon'  ng-class='{disabled:mined}'></i>	<i ng-if='hasButtons' ng-click='incrMins()'  ng-show='showButtons||hoursFocused||minsFocused' class='lui mp-button top right plus icon'     ng-class='{disabled:maxed}'></i>	<i ng-if='hasButtons' ng-click='decrMins()'  ng-show='showButtons||hoursFocused||minsFocused' class='lui mp-button bottom right minus icon' ng-class='{disabled:mined}'></i></div>")}]),angular.module("lui.directives").directive("luidSelectOnClick",function(){return{restrict:"A",link:function(a,b,c){b.on("click",function(){this.select()}),b.on("focus",function(){this.select()})}}}),angular.module("lui.directives").directive("luidFocusOn",function(){return function(a,b,c){a.$on(c.focusOn,function(a){b[0].focus()})}})}(),function(){"use strict";angular.module("lui.directives").directive("luidTimespan",["moment",function(a){function b(b,c,d,e){var f=e[1],g=e[0];if(b.pattern=/^([0-9]+)((h([0-9]{2})?)?(m(in)?)?)?$/i,d.unit){var h=b.$eval(d.unit);("h"==h||"hour"==h||"hours"==h)&&(b.useHours=!0)}b.ngModelCtrl=f,f.$render=function(){if(!this.$viewValue)return void(b.strDuration="");var c=a.duration(this.$viewValue),d=Math.floor(c.asHours()),e=c.minutes();0===d?b.strDuration=e+"m":b.strDuration=(10>d?"0":"")+d+"h"+(10>e?"0":"")+e},f.$viewChangeListeners.push(function(){b.$eval(d.ngChange)}),g.setupEvents(c.find("input"))}return{require:["luidTimespan","^ngModel"],controller:"luidTimespanController",scope:{step:"=",unit:"=",ngDisabled:"=",placeholder:"@"},restrict:"EA",link:b,template:"<input type='text' ng-disabled='ngDisabled' placeholder='{{placeholder}}' ng-pattern='pattern' ng-model='strDuration' ng-change='updateValue()' ng-blur='formatInputValue()'>"}}]).controller("luidTimespanController",["$scope","moment",function(a,b){a.updateValue=function(){if(!a.strDuration)return k(void 0);var b,e;b=d(a.strDuration),e=c(b),k(e)};var c=function(a){return(a.days()>0?Math.floor(a.asDays())+".":"")+(a.hours()<10?"0":"")+a.hours()+":"+(a.minutes()<10?"0":"")+a.minutes()+":00"},d=function(b){var c;return c=/h/i.test(b)?e(b):/m/i.test(b)?f(b):a.useHours?g(b):f(b)},e=function(a){var c=b.duration(),d=a.split(/h/i);c.add(parseInt(d[0]),"hours");var e=d[1];return e&&e.length>=2&&c.add(parseInt(e.substring(0,2)),"minutes"),c},f=function(a){var c=b.duration(),d=a.split(/m/i);return c.add(parseInt(d[0]),"minutes"),c},g=function(a){var c=b.duration(),d=a.split(/h/i);return c.add(parseInt(d[0]),"hours"),c},h=function(a){return Math.floor(a.asDays())+"."+(a.hours()<10?"0":"")+a.hours()+":"+(a.minutes()<10?"0":"")+a.minutes()+":00"},i=function(a){var c=b.duration(l()).add(a,"minutes");c.asMilliseconds()<0&&(c=b.duration());var d=h(c);j(d)},j=function(b){a.ngModelCtrl.$setViewValue(b),a.ngModelCtrl.$render()},k=function(b){a.ngModelCtrl.$setViewValue(b)};a.formatInputValue=function(){a.ngModelCtrl.$render()};var l=function(){return a.ngModelCtrl.$viewValue};this.setupEvents=function(a){m(a),n(a)};var m=function(b){var c=5;isNaN(parseInt(a.step))||(c=parseInt(a.step)),b.bind("keydown",function(b){38===b.which?(b.preventDefault(),i(c),a.$apply()):40===b.which&&(b.preventDefault(),i(-c),a.$apply()),13===b.which&&(b.preventDefault(),a.formatInputValue(),a.$apply())})},n=function(b){var c=5;isNaN(parseInt(a.step))||(c=parseInt(a.step));var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){this===document.activeElement&&(a.$apply(i(d(b)?c:-c)),b.preventDefault())})}}])}(),function(){"use strict";angular.module("lui.services").service("luisNotify",["$log","notify",function(a,b){var c='<div class="lui callout filled" ng-click="$close()" style="width:25em;z-index:999"ng-class="[$classes, '+"$position === 'center' ? 'cg-notify-message-center' : '', $position === 'left' ? 'cg-notify-message-left' : '', $position === 'right' ? 'cg-notify-message-right' : '']\" ng-style=\"{'margin-left': $centerMargin}\"> 	<h5>{{\"ERROR\" | translate}}</h5>	<div ng-show=\"!$messageTemplate\">	{{$message|translate}}	</div></div>",d={};return d.error=function(d,e){a.error(d),b({startTop:40,duration:2e4,template:c,position:e||"center",message:"ERR_"+d.cause,classes:["red"]})},d}])}();