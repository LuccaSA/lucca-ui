/*! lucca-ui 29-04-2022 */
var Lui,lui;!function(){"use strict";angular.module("moment",[]).factory("moment",()=>moment),angular.module("underscore",[]).factory("_",()=>_),angular.module("iban",[]).factory("iban",()=>IBAN),angular.module("lui",["ngSanitize","ui.bootstrap","ui.select","moment","underscore"]),angular.module("lui.translate",["lui","pascalprecht.translate"]),angular.module("lui.notify",["lui","cgNotify"]),angular.module("lui.formly",["lui","formly"]),angular.module("lui.crop",["lui","lui.translate","uiCropper"]),angular.module("lui.iban",["lui","iban"]),angular.module("lui.tablegrid",["lui","lui.translate"])}(lui=lui||{}),function(e){!function(){"use strict";angular.module("lui").directive("luiCloak",["$timeout",i=>({restrict:"A",link:(e,t,s)=>{i(()=>{s.$set("luiCloak",void 0),t.removeClass("lui-cloak")},0)}})])}(e.cloak||(e.cloak={}))}(lui=lui||{}),function(e){!function(){"use strict";class e{constructor(e){this.$get=["$log",e=>new t(this.config,e)],this.config={},this.$uibModalProvider=e}setConfig(e){this.config=e;e=new t(this.config);this.configureNguibs(e)}configureNguibs(e){this.$uibModalProvider.options={windowClass:e.prefix,backdropClass:e.prefix,animation:!0,backdrop:!0,appendTo:e.parentElt,size:"large"}}}e.$inject=["$uibModalProvider"];class t{constructor(e,t){var s,i,l;_.extend(this,e),!this.parentElt&&this.parentTagIdClass&&(e=this.parentTagIdClass||"body",s=document.getElementsByTagName(e),i=document.getElementById(e),l=document.getElementsByClassName(e),s&&s.length?this.parentElt=angular.element(s[0]):i?this.parentElt=angular.element(i):l&&l.length?this.parentElt=angular.element(l[0]):t&&t.warn("luisConfig - could not find a suitable element for tag/id/class: "+e)),this.prefix=this.prefix||"lui",this.startTop=this.startTop||40,this.okLabel=this.okLabel||"Ok",this.cancelLabel=this.cancelLabel||"Cancel",this.canDismissConfirm=this.canDismissConfirm}}angular.module("lui").provider("luisConfig",e)}(e.config||(e.config={}))}(lui=(lui=lui||{})||{}),function(e){!function(e){"use strict";class t{constructor(e){this.date=moment(e)}}e.CalendarDate=t;e.Calendar=class{constructor(e){this.date=moment(e),this.weeks=[],this.months=[],this.years=[],this.currentYear=this.date.year()===moment().year()}};e.CalendarWeek=class{};e.CalendarDay=class extends t{constructor(e){super(e),this.dayNum=e.date()}};e.Shortcut=class{},(e=e.CalendarMode||(e.CalendarMode={}))[e.Days=0]="Days",e[e.Months=1]="Months",e[e.Years=2]="Years"}(e.datepicker||(e.datepicker={}))}(lui=lui||{}),function(e){!function(l){"use strict";l.CalendarController=class{constructor(e,t){this.minMode=l.CalendarMode.Days,this.$scope=e,this.$log=t,this.initCalendarScopeMethods(e),this.setMinMode(e.minMode),this.$scope.mode=this.minMode,e.direction="init"}setCalendarCnt(e,t){this.calendarCnt=parseInt(e,10)||1,t&&2<this.calendarCnt&&(this.calendarCnt=2,this.$log.warn("no more than 2 months displayed in a date-picker popover"))}constructCalendars(){return _.map(_.range(this.calendarCnt),e=>this.constructCalendar(this.currentDate,e))}constructDayLabels(){return _.map(_.range(7),e=>moment().startOf("week").add(e,"days").format("dd"))}assignClasses(){switch(this.$scope.mode){case l.CalendarMode.Days:return this.assignDayClasses();case l.CalendarMode.Months:return this.assignMonthClasses();case l.CalendarMode.Years:return this.assignYearClasses()}}setMinMode(e){switch((e||"").toLowerCase()){case"0":case"d":case"day":case"days":this.minMode=l.CalendarMode.Days;break;case"1":case"m":case"month":case"months":this.minMode=l.CalendarMode.Months;break;case"2":case"y":case"year":case"years":this.minMode=l.CalendarMode.Years;break;default:this.minMode=l.CalendarMode.Days}}assignDayClasses(){var e=this.extractDays();_.each(e,e=>{e.selected=!1,e.start=!1,e.end=!1,e.inBetween=!1,this.selected&&e.date.format("YYYYMMDD")===moment(this.selected).format("YYYYMMDD")&&(e.selected=!0),this.start&&e.date.format("YYYYMMDD")===moment(this.start).format("YYYYMMDD")&&(e.start=!0),this.end&&e.date.format("YYYYMMDD")===moment(this.end).format("YYYYMMDD")&&(e.end=!0),this.start&&this.end&&e.date.isSameOrAfter(this.start)&&e.date.isSameOrBefore(this.end)&&(e.inBetween=!0),this.min&&0<this.min.diff(e.date)&&(e.disabled=!0),this.max&&this.max.diff(e.date)<0&&(e.disabled=!0),this.$scope.customClass&&(e.customClass=this.$scope.customClass(e.date,l.CalendarMode.Days))})}assignMonthClasses(){var e=this.extractMonths();_.each(e,e=>{e.selected=!1,e.start=!1,e.end=!1,e.inBetween=!1,this.selected&&e.date.format("YYYYMM")===moment(this.selected).format("YYYYMM")&&(e.selected=!0),this.start&&e.date.format("YYYYMM")===moment(this.start).format("YYYYMM")&&(e.start=!0),this.end&&e.date.format("YYYYMM")===moment(this.end).format("YYYYMM")&&(e.end=!0),this.start&&this.end&&!e.start&&!e.end&&e.date.isSameOrAfter(this.start)&&e.date.isSameOrBefore(this.end)&&(e.inBetween=!0),this.min&&0<this.min.diff(moment(e.date).endOf("month"))&&(e.disabled=!0),this.max&&this.max.diff(e.date)<0&&(e.disabled=!0),this.$scope.customClass&&(e.customClass=this.$scope.customClass(e.date,l.CalendarMode.Months))})}assignYearClasses(){var e=this.extractYears();_.each(e,e=>{e.selected=!1,e.start=!1,e.end=!1,e.inBetween=!1,this.selected&&e.date.format("YYYY")===moment(this.selected).format("YYYY")&&(e.selected=!0),this.start&&e.date.format("YYYY")===moment(this.start).format("YYYY")&&(e.start=!0),this.end&&e.date.format("YYYY")===moment(this.end).format("YYYY")&&(e.end=!0),this.start&&this.end&&!e.start&&!e.end&&e.date.isSameOrAfter(this.start)&&e.date.isSameOrBefore(this.end)&&(e.inBetween=!0),this.min&&0<this.min.diff(moment(e.date).endOf("year"))&&(e.disabled=!0),this.max&&this.max.diff(e.date)<0&&(e.disabled=!0),this.$scope.customClass&&(e.customClass=this.$scope.customClass(e.date,l.CalendarMode.Years))})}initCalendarScopeMethods(t){t.dayLabels=this.constructDayLabels(),t.next=()=>{this.changeCurrentDate(1),t.calendars=this.constructCalendars(),t.direction="next",this.assignClasses()},t.previous=()=>{this.changeCurrentDate(-1),t.calendars=this.constructCalendars(),t.direction="previous",this.assignClasses()},t.switchToMonthMode=()=>{t.mode=l.CalendarMode.Months,t.direction="mode-change out",this.currentDate.startOf("year"),t.calendars=this.constructCalendars(),this.assignClasses()},t.switchToYearMode=()=>{t.mode=l.CalendarMode.Years,t.direction="mode-change out",t.calendars=this.constructCalendars(),this.assignClasses()},t.selectDay=e=>{this.selectDate(e.date)},t.selectMonth=e=>{this.minMode===l.CalendarMode.Months?this.selectDate(e.date):(this.currentDate=e.date,t.mode=l.CalendarMode.Days,t.direction="mode-change in",t.calendars=this.constructCalendars(),this.assignClasses())},t.selectYear=e=>{this.minMode===l.CalendarMode.Years?this.selectDate(e.date):(this.currentDate=e.date,t.mode=l.CalendarMode.Months,t.direction="mode-change in",t.calendars=this.constructCalendars(),this.assignClasses())}}constructCalendar(e,t){let s;switch(this.$scope.mode){case l.CalendarMode.Days:return(s=new l.Calendar(moment(e).startOf("month").add(t,"month"))).weeks=this.constructWeeks(s.date),s;case l.CalendarMode.Months:return(s=new l.Calendar(moment(e).startOf("year").add(t,"year"))).months=this.constructDates(s.date,"months"),s;case l.CalendarMode.Years:return(s=new l.Calendar(moment(e).startOf("year").add(12*t,"year"))).years=this.constructDates(s.date,"years"),s}}constructDates(t,s){return _.map(_.range(12),e=>new l.CalendarDate(moment(t).add(e,s)))}constructWeeks(e){let t=[],s=moment(e).startOf("week");for(;s.month()===e.month()||moment(s).endOf("week").month()===e.month();)t.push(this.constructWeek(s,e)),s.add(1,"week");return t}constructWeek(s,i){let e={days:[]};return e.days=_.map(_.range(7),e=>{let t=new l.CalendarDay(moment(s).add(e,"days"));return t.date.month()!==i.month()&&(t.empty=!0),t}),e}extractDays(){return _.chain(this.$scope.calendars).pluck("weeks").flatten().pluck("days").flatten().reject(e=>e.empty).value()}extractMonths(){return _.chain(this.$scope.calendars).pluck("months").flatten().value()}extractYears(){return _.chain(this.$scope.calendars).pluck("years").flatten().value()}changeCurrentDate(e){switch(this.$scope.mode){case l.CalendarMode.Days:this.currentDate.add(e,"months");break;case l.CalendarMode.Months:this.currentDate.add(e,"years");break;case l.CalendarMode.Years:this.currentDate.add(12*e,"years")}}}}(e.datepicker||(e.datepicker={}))}(lui=lui||{}),function(l){!function(i){"use strict";class e{constructor(){this.restrict="E",this.templateUrl="lui/templates/date-picker/datepicker-inline.html",this.require=["ngModel","luidDatePicker"],this.scope={format:"@",displayedCalendars:"@",minMode:"@",min:"=",max:"=",customClass:"="},this.controller=s.IID}static factory(){return()=>new e}link(e,t,s,i){var l=i[0];let r=i[1];r.setFormat(e.format),r.setNgModelCtrl(l),r.setCalendarCnt(e.displayedCalendars)}}e.IID="luidDatePicker";class t{constructor(){this.restrict="E",this.templateUrl="lui/templates/date-picker/datepicker-popup.html",this.require=["ngModel","luidDatePickerPopup"],this.scope={format:"@",displayFormat:"@",displayedCalendars:"@",minMode:"@",min:"=",max:"=",customClass:"=",placeholder:"@",shortcuts:"=",groupedShortcuts:"=",disableKeyboardInput:"="},this.controller=s.IID}static factory(){return()=>new t}link(e,t,s,i){var l=i[0];let r=i[1];r.setElement(t),r.setFormat(e.format,e.displayFormat),r.setNgModelCtrl(l),r.setCalendarCnt(e.displayedCalendars,!0),r.setPopoverTrigger(t,e)}}t.IID="luidDatePickerPopup";class s extends i.CalendarController{constructor(i,e,t){super(i,e),(this.$scope=i).togglePopover=e=>{this.togglePopover(e)},i.openPopover=e=>{this.openPopover(e)},i.closePopoverOnKeyPress={9:e=>{this.closePopover(),this.$scope.$apply()},13:e=>{this.closePopover(),this.$scope.$apply(),this.element.find("input")[0].blur()}},i.$watch("min",()=>{this.min=this.formatter.parseValue(i.min),this.validate(),this.selected=this.getViewValue(),this.assignClasses()}),i.$watch("max",()=>{this.max=this.formatter.parseValue(i.max),this.validate(),this.selected=this.getViewValue(),this.assignClasses()}),i.clear=e=>{this.setViewValue(void 0),this.$scope.displayStr="",this.closePopover(),this.selected=void 0,this.assignClasses(),e.stopPropagation()},i.selectShortcut=e=>{e=this.formatter.parseValue(e.date);this.setViewValue(e),this.$scope.displayStr=this.getDisplayStr(e),this.closePopover(),this.selected=e,this.assignClasses()},i.onDisplayStrChanged=e=>{var t=i.displayStr;let s=moment(t,i.displayFormat);(s.isValid()||(s=moment(t,i.format)).isValid())&&(this.setViewValue(s),this.render(),i.displayStr=t),this.validate()}}setNgModelCtrl(e){(this.ngModelCtrl=e).$render=()=>{this.render()},e.$validators.min=(e,t)=>{let s=this.min;var i=this.getViewValue();return!i||!s||s.diff(i)<=0},e.$validators.max=(e,t)=>{let s=this.max;var i=this.getViewValue();return!i||!s||0<=s.diff(i)},this.$scope.customClass&&(e.$validators.customClass=(e,t)=>{var s=this.getViewValue();if(this.$scope.customClass&&s){let e=this.$scope.customClass(s,i.CalendarMode.Days).toLowerCase();return-1===e.indexOf("disabled")&&-1===e.indexOf("forbidden")}return!0})}setFormat(e,t){this.formatter=new l.formatter.MomentFormatter(e),this.displayFormat="moment"!==e&&"date"!==e?t||e||"L":t||"L"}selectDate(e){this.setViewValue(e),this.$scope.displayStr=this.getDisplayStr(e),this.selected=e,this.assignClasses(),this.closePopover()}setPopoverTrigger(e,t){this.popoverController=new l.popover.ClickoutsideTrigger(e,t,()=>{this.ngModelCtrl.$setTouched(),this.closePopover()}),t.popover={isOpen:!1},t.togglePopover=e=>{this.togglePopover(e)}}setElement(e){this.element=e}setViewValue(e){this.ngModelCtrl.$setViewValue(this.formatter.formatValue(e)),this.ngModelCtrl.$setTouched()}getViewValue(){return this.formatter.parseValue(this.ngModelCtrl.$viewValue)}validate(){this.ngModelCtrl.$validate()}render(){var e=this.formatter.parseValue(this.ngModelCtrl.$viewValue);this.currentDate=moment(e).startOf("month"),this.$scope.mode=this.minMode,this.$scope.calendars=this.constructCalendars(),this.selected=e,this.min=this.formatter.parseValue(this.$scope.min),this.max=this.formatter.parseValue(this.$scope.max),this.assignClasses(),this.$scope.displayStr=this.getDisplayStr(e)}togglePopover(e){this.$scope.popover.isOpen?this.closePopover():this.openPopover(e)}closePopover(){this.$scope.displayStr=this.getDisplayStr(this.getViewValue()),this.$scope.direction="",this.element.removeClass("ng-open"),this.popoverController&&this.popoverController.close()}openPopover(e){if(this.element.addClass("ng-open"),this.$scope.direction="init",this.popoverController&&(this.render(),this.popoverController.open(e)),!this.$scope.disableKeyboardInput){let e=this.element.children().children()[0];e.select()}}getDisplayStr(e){return e?e.format(this.displayFormat||"L"):void 0}}s.IID="luidDatePickerController",s.$inject=["$scope","$log","$timeout"],angular.module("lui").controller(s.IID,s),angular.module("lui").directive(e.IID,e.factory()),angular.module("lui").directive(t.IID,t.factory())}(l.datepicker||(l.datepicker={}))}(lui=lui||{}),function(i){!function(l){"use strict";angular.module("lui").directive("autoFocus",()=>({restrict:"A",link:(e,t)=>{t[0].focus()}}));class e{constructor(){this.restrict="E",this.templateUrl="lui/templates/date-picker/daterangepicker.html",this.require=["ngModel","luidDaterangePicker"],this.scope={format:"@",displayFormat:"@",rangeFormat:"@",minMode:"@",min:"=",max:"=",customClass:"=",excludeEnd:"@",startProperty:"@",endProperty:"@",placeholder:"@",shortcuts:"=",groupedShortcuts:"=",disableKeyboardInput:"="},this.controller=t.IID}static factory(){return()=>new e}link(e,t,s,i){var l=i[0];let r=i[1];r.setNgModelCtrl(l),r.setFormat(e.format,e.displayFormat),r.setCalendarCnt("2",!0),r.setPopoverTrigger(t,e),r.setExcludeEnd(e.excludeEnd),r.setProperties(e.startProperty,e.endProperty),r.setElement(t)}}e.IID="luidDaterangePicker";class t extends l.CalendarController{constructor(l,e,t){super(l,t),this.$scope=l,this.$filter=e,l.internal={},"fr"===moment.locale()?(l.fromLabel="Du",l.toLabel="Au"):(l.fromLabel="From",l.toLabel="To"),this.rangeFormatDictionary={en:{other:l.rangeFormat}},l.internal.startDisplayStr="",l.internal.endDisplayStr="",l.focusEndInputOnTab={9:e=>{this.$scope.editEnd(e)}},l.closePopoverOnTab={9:e=>{this.closePopover(),this.$scope.$apply()}},l.selectShortcut=e=>{l.period=this.toPeriod(e),l.displayStr=this.$filter("luifFriendlyRange")(this.$scope.period,!1,this.rangeFormatDictionary),this.setViewValue(l.period),this.closePopover()},l.onStartDisplayStrChanged=e=>{var t=l.internal.startDisplayStr,s=l.displayFormat||"L";let i;if(moment(t,s).isValid())i=moment(t,s);else{if(!moment(t,l.format).isValid())return;i=moment(t,l.format)}this.selectDate(i,!1,!1),this.currentDate=this.$scope.period.start,this.start=this.$scope.period.start,l.calendars=this.constructCalendars(),this.assignClasses()},l.onEndDisplayStrChanged=e=>{var t=l.internal.endDisplayStr,s=l.displayFormat||"L";let i;if(moment(t,s).isValid())i=moment(t,s);else{if(!moment(t,l.format).isValid())return;i=moment(t,l.format)}this.selectDate(i,!1,!1),this.currentDate=moment(this.$scope.period.end),this.end=this.currentDate,l.calendars=this.constructCalendars(),this.assignClasses()},l.editStart=e=>{e&&e.stopPropagation(),l.editingStart=!0,this.$scope.period.start&&0<moment(this.currentDate).diff(this.$scope.period.start)&&(this.currentDate=moment(this.$scope.period.start).startOf("month"),this.$scope.calendars=this.constructCalendars(),this.assignClasses())},l.editEnd=e=>{e&&e.stopPropagation(),l.editingStart=!1,this.$scope.period.end&&moment(this.currentDate).add(this.calendarCnt,"months").diff(this.$scope.period.end)<=0&&(this.currentDate=moment(this.$scope.period.end).add(1-this.calendarCnt,"months").startOf("month"),this.$scope.calendars=this.constructCalendars(),this.assignClasses())},l.onMouseEnter=(e,t)=>{l.editingStart||this.$scope.period.end||(this.end=e.date,this.assignClasses())},l.onMouseLeave=(e,t)=>{l.editingStart||this.$scope.period.end||(this.end=void 0,this.assignClasses())},l.popover={isOpen:!1},l.clear=e=>{l.period.start=void 0,l.period.end=void 0,this.setViewValue(void 0),this.closePopover(),e.stopPropagation()}}setElement(e){this.element=e}setNgModelCtrl(e){(this.ngModelCtrl=e).$render=()=>{e.$viewValue?(this.$scope.period=this.getViewValue(),this.$scope.displayStr=this.$filter("luifFriendlyRange")(this.$scope.period,!1,this.rangeFormatDictionary),this.$scope.internal.startDisplayStr=this.$scope.period.start?this.$scope.period.start.format(this.$scope.displayFormat||"L"):"",this.$scope.internal.endDisplayStr=this.$scope.period.end?this.$scope.period.end.format(this.$scope.displayFormat||"L"):""):(this.$scope.period=void 0,this.$scope.displayStr=void 0,this.$scope.internal.startDisplayStr=void 0,this.$scope.internal.endDisplayStr=void 0)},e.$isEmpty=e=>{e=this.toPeriod(e);return!e||!e.start&&!e.end},e.$validators.min=(e,t)=>{var s=this.getViewValue().start;let i=this.formatter.parseValue(this.$scope.min);return!s||!i||i.diff(s)<=0},e.$validators.max=(e,t)=>{var s=this.getViewValue().end;let i=this.formatter.parseValue(this.$scope.max);return!s||!i||0<=i.diff(s)},this.$scope.customClass&&(e.$validators.customClass=(e,t)=>{var i=this.getViewValue();if(this.$scope.customClass&&i){let t=!0,s=!0;if(i.start){let e=this.$scope.customClass(i.start,l.CalendarMode.Days).toLowerCase();t=-1===e.indexOf("disabled")&&-1===e.indexOf("forbidden")}if(i.end){let e=this.$scope.customClass(i.end,l.CalendarMode.Days).toLowerCase();s=-1===e.indexOf("disabled")&&-1===e.indexOf("forbidden")}return t&&s}return!0})}setProperties(e,t){this.startProperty=e||"start",this.endProperty=t||"end"}setExcludeEnd(e){this.excludeEnd="true"===e}setFormat(e,t){this.formatter=new i.formatter.MomentFormatter(e),this.$scope.momentFormat="moment"!==e&&"date"!==e?t||e||"L":t||"L"}setPopoverTrigger(e,t){this.popoverController=new i.popover.ClickoutsideTrigger(e,t,()=>{this.closePopover()}),t.togglePopover=e=>{this.togglePopover(e)}}selectDate(e,t=!0,s=!0){if(this.$scope.editingStart)this.$scope.period.start=e,this.start=e,s&&(this.$scope.internal.startDisplayStr=e.format(this.$scope.displayFormat||"L")),t&&this.$scope.editEnd(),this.$scope.period.end&&this.$scope.period.start.isAfter(this.$scope.period.end)&&(this.$scope.period.end=void 0,this.end=void 0),this.assignClasses();else{switch(this.minMode){case l.CalendarMode.Months:this.$scope.period.end=e.endOf("month").startOf("day");break;case l.CalendarMode.Years:this.$scope.period.end=e.endOf("year").startOf("day");break;default:this.$scope.period.end=e,s&&(this.$scope.internal.endDisplayStr=e.format(this.$scope.displayFormat))}this.$scope.period.start?t&&this.closePopover():this.$scope.editStart()}}setViewValue(e){let t=_.clone(this.ngModelCtrl.$viewValue);if(!e&&!t)return this.$scope.internal.startDisplayStr="",this.$scope.internal.endDisplayStr="",this.ngModelCtrl.$setViewValue(void 0);t=t||{},e?(t[this.startProperty]=e.start?this.formatter.formatValue(moment(e.start)):void 0,t[this.endProperty]=e.end?this.formatter.formatValue(this.excludeEnd?moment(e.end).add(1,"day"):moment(e.end)):void 0,this.$scope.internal.startDisplayStr=e.start?e.start.format(this.$scope.displayFormat||"L"):void 0,this.$scope.internal.endDisplayStr=e.end?e.end.format(this.$scope.displayFormat||"L"):void 0):(t[this.startProperty]=void 0,t[this.endProperty]=void 0,this.$scope.internal.startDisplayStr="",this.$scope.internal.endDisplayStr=""),this.ngModelCtrl.$setViewValue(t)}getViewValue(){return this.toPeriod(this.ngModelCtrl.$viewValue)}toPeriod(e){if(!e)return{start:void 0,end:void 0};let t={},s=(t.start=e[this.startProperty],t.end=e[this.endProperty],new i.Period(t,this.formatter));return this.excludeEnd&&s.end&&s.end.add(-1,"day"),s}togglePopover(e){this.$scope.popover.isOpen?this.closePopover():this.openPopover(e)}closePopover(){var e;this.$scope.period.start&&this.$scope.period.end&&this.$scope.period.start.isAfter(this.$scope.period.end)&&(e=this.$scope.period.start,this.$scope.period.start=this.$scope.period.end,this.$scope.period.end=e),this.$scope.direction="",this.setViewValue(this.$scope.period),this.$scope.displayStr=this.$filter("luifFriendlyRange")(this.$scope.period,!1,this.rangeFormatDictionary),this.element.removeClass("ng-open"),this.popoverController.close()}openPopover(e){var t=this.getViewValue();this.$scope.period=t||{start:void 0,end:void 0},this.currentDate=(t?moment(t.start):moment()).startOf("month"),this.$scope.mode=this.minMode,this.$scope.direction="init",this.$scope.calendars=this.constructCalendars(),t&&(this.start=t.start,this.end=t.end),this.min=this.formatter.parseValue(this.$scope.min),this.max=this.formatter.parseValue(this.$scope.max),this.assignClasses(),this.$scope.editingStart=!0,this.element.addClass("ng-open"),this.popoverController.open(e)}}t.IID="luidDaterangePickerController",t.$inject=["$scope","$filter","$log"],angular.module("lui").controller(t.IID,t),angular.module("lui").directive(e.IID,e.factory())}(i.datepicker||(i.datepicker={}))}(lui=lui||{}),function(t){!function(){"use strict";function e(){return function(e,t){let s=t.toLowerCase();var t=_.filter(e,e=>0===e.name.toLowerCase().indexOf(s)),i=_.chain(e).difference(t).filter(e=>-1<e.name.toLowerCase().indexOf(s)).value(),e=_.filter(e,e=>-1===e.name.toLowerCase().indexOf(s)&&!!e.ancestorsLabel&&-1<e.ancestorsLabel.toLowerCase().indexOf(s));return _.union(t,i,e)}}(t.departmentpicker||(t.departmentpicker={})).DepartmentFilter=e,angular.module("lui").filter("departmentFilter",e)}()}(lui=lui||{}),function(e){e.departmentpicker||(e.departmentpicker={})}(lui=lui||{}),function(e){!function(t){"use strict";t.MAGIC_PAGING=15;class e{constructor(e,t,s){this.$scope=e,this.$filter=t,this.departmentPickerService=s,this.initDepartments(),this.initScope()}setNgModelCtrl(e){this.ngModelCtrl=e,this.ngModelCtrl.$render=()=>{this.ngModelCtrl.$modelValue&&(this.$scope.internal.selectedDepartment=this.ngModelCtrl.$modelValue)}}initScope(){this.$scope.internal={selectedDepartment:void 0},this.$scope.selectDepartment=()=>{this.setViewValue(this.$scope.internal.selectedDepartment)},this.$scope.loadMore=e=>{this.$scope.departmentsToDisplay.length<this.departments.length&&(this.filterDepartments(e),this.$scope.$apply())},this.$scope.getLevel=e=>new Array(e.level),this.$scope.search=e=>{this.$scope.departmentsToDisplay=[],this.$scope.$apply(),this.filterDepartments(e)}}initDepartments(){this.$scope.departmentsToDisplay=[],this.departmentPickerService.getDepartments().then(e=>{this.departments=e,this.filterDepartments()})}filterDepartments(e=""){e=this.$filter("departmentFilter")(this.departments,e);this.$scope.departmentsToDisplay=_.first(e,this.$scope.departmentsToDisplay.length+t.MAGIC_PAGING)}setViewValue(e){this.ngModelCtrl.$setViewValue(angular.copy(e))}}e.IID="luidDepartmentPickerController",e.$inject=["$scope","$filter","departmentPickerService"],t.LuidDepartmentPickerController=e,angular.module("lui").controller(e.IID,e)}(e.departmentpicker||(e.departmentpicker={}))}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(){this.restrict="E",this.templateUrl="lui/templates/department-picker/department-picker.html",this.require=["^ngModel",t.IID],this.scope={},this.controller=e.LuidDepartmentPickerController.IID}static factory(){return()=>new t}link(e,t,s,i){var l=i[0];let r=i[1];r.setNgModelCtrl(l),e.onDropdownToggle=e=>{e?t.addClass("ng-open"):t.removeClass("ng-open")}}}t.IID="luidDepartmentPicker",angular.module("lui.translate").directive(t.IID,t.factory())}(e.departmentpicker||(e.departmentpicker={}))}(lui=lui||{}),function(e){e.departmentpicker||(e.departmentpicker={})}(lui=lui||{}),function(e){!function(){"use strict";class e{constructor(e){this.$http=e}getDepartments(){return this.getDepartmentsTree().then(e=>{e=e.children;return this.buildDepartmentsArrayRecursively(e)})}getDepartmentsTree(){return this.$http.get("/api/v3/departments/tree?fields=id,name").then(e=>e.data.data)}buildDepartmentsArrayRecursively(e){let t=[];return e&&_.each(e,e=>{this.setAncestry(e.node,e.children),t.push(e.node),t=_.flatten([t,this.buildDepartmentsArrayRecursively(e.children)])}),t}setAncestry(t,e){void 0===t.level&&(t.level=0),0<e.length&&(t.hasChild=!0),_.each(e,e=>{e.node.ancestorsLabel?e.node.ancestorsLabel+=" > ":e.node.ancestorsLabel="",e.node.ancestorsLabel+=t.name,e.node.level=t.level+1,this.setAncestry(t,e.children)})}}e.IID="departmentPickerService",e.$inject=["$http"],angular.module("lui").service(e.IID,e)}(e.departmentpicker||(e.departmentpicker={}))}(lui=lui||{}),function(){"use strict";(lui||(lui={})).Period=class{constructor(e,t){var s=e.start||e.startsOn||e.startsAt,e=e.end||e.endsOn||e.endsAt;this.start=t.parseValue(s),this.end=t.parseValue(e)}}}(),function(e){!function(){"use strict";let e=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];angular.module("lui").filter("luifStripAccents",function(){return function(t){return null==t?"":(_.each(e,function(e){t=t.replace(e.letters,e.base)}),t)}})}(e.Filters||(e.Filters={}))}(Lui=Lui||{}),function(){"use strict";angular.module("lui.formly").config(["formlyConfigProvider",e=>{e.setType({name:"text",templateUrl:"lui/templates/formly/fields/text.html"}),e.setType({name:"textarea",templateUrl:"lui/templates/formly/fields/textarea.html"}),e.setType({name:"number",templateUrl:"lui/templates/formly/fields/number.html"}),e.setType({name:"email",templateUrl:"lui/templates/formly/fields/email.html"}),e.setType({name:"date",templateUrl:"lui/templates/formly/fields/date.html"}),e.setType({name:"daterange",templateUrl:"lui/templates/formly/fields/daterange.html"}),e.setType({name:"select",templateUrl:"lui/templates/formly/fields/select.html"}),e.setType({name:"checkbox",templateUrl:"lui/templates/formly/fields/checkbox.html"}),e.setType({name:"radio",templateUrl:"lui/templates/formly/fields/radio.html"}),e.setType({name:"picture",templateUrl:"lui/templates/formly/fields/picture.html"}),e.setType({name:"portrait",templateUrl:"lui/templates/formly/fields/portrait.html"}),e.setType({name:"user",templateUrl:"lui/templates/formly/fields/user.html"}),e.setType({name:"user_multiple",templateUrl:"lui/templates/formly/fields/user-multiple.html"}),e.setType({name:"api_select",templateUrl:"lui/templates/formly/fields/api-select.html"}),e.setType({name:"api_select_multiple",templateUrl:"lui/templates/formly/fields/api-select-multiple.html"}),e.setType({name:"iban",templateUrl:"lui/templates/formly/fields/iban.html"}),e.setType({name:"department",templateUrl:"lui/templates/formly/fields/department.html"})}])}(Lui=Lui||{}),function(e){!function(){"use strict";class e{constructor(){this.restrict="AE",this.templateUrl="lui/templates/formly/inputs/api-select.html",this.scope={api:"=",filter:"=",orderBy:"=",placeholder:"@",allowClear:"="},this.controller=s.IID}static factory(){return()=>new e}link(e,t){e.onDropdownToggle=e=>{e?t.addClass("ng-open"):t.removeClass("ng-open")}}}e.IID="luidApiSelect";class t{constructor(){this.restrict="AE",this.templateUrl="lui/templates/formly/inputs/api-select-multiple.html",this.scope={api:"=",filter:"=",orderBy:"=",placeholder:"@"},this.controller=s.IID}static factory(){return()=>new t}link(e,t){e.onDropdownToggle=e=>{e?t.addClass("ng-open"):t.removeClass("ng-open")}}}t.IID="luidApiSelectMultiple";class s{constructor(s,e,i){this.offset=0;let t;function l(){t&&e.cancel(t),t=e(()=>{s.refresh(""),t=void 0},250)}s.$watch("filter",()=>{l()}),s.$watch("api",()=>{l()}),s.$watch("order",()=>{l()}),s.refresh=e=>{this.offset=0;i.get(e,s.api,s.filter,"0,25",s.orderBy).then(e=>{s.choices=e,this.offset=s.choices.length})};let r;s.loadMore=e=>{var t;r||(t=this.offset+","+(this.offset+25),s.choices.push({id:0,loading:!0,name:""}),r=i.get(e,s.api,s.filter,t,s.orderBy).then(e=>{s.choices=_.chain(s.choices).reject(e=>e.loading).union(e).uniq(e=>e.id).value(),this.offset=s.choices.length,r=void 0},()=>{r=void 0}))}}}s.IID="luidApiSelectController",s.$inject=["$scope","$timeout","luisStandardApiService"],angular.module("lui").controller(s.IID,s),angular.module("lui").directive(e.IID,e.factory()),angular.module("lui").directive(t.IID,t.factory())}(e.apiselect||(e.apiselect={}))}(lui=(lui=lui||{})||{}),function(e){!function(e){"use strict";class t{constructor(e){this.$http=e}get(e,t,s,i,l){e=_.reject(["fields=id,name",e?"name=like,"+e:void 0,i?"paging="+i:void 0,s,l?"orderBy="+l:void 0],e=>!e).join("&");return this.$http.get(t+"?"+e).then(e=>-1!==t.indexOf("/v3/")?e.data.data.items:e.data.data)}}t.IID="luisStandardApiService",t.$inject=["$http"],e.StandardApiService=t,angular.module("lui").service(t.IID,t)}(e.apiselect||(e.apiselect={}))}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(e,t){this.$scope=e,this.ibanChecker=t,this.initScope()}setNgModelCtrl(e){this.ngModelCtrl=e,this.ngModelCtrl.$render=()=>{let e=this.getViewValue()?this.getViewValue().replace(" ",""):null;e?(this.$scope.countryCode=e.substring(0,2),this.$scope.controlKey=e.substring(2,4),this.$scope.bban=e.substring(4)):(this.$scope.countryCode="",this.$scope.controlKey="",this.$scope.bban="")},this.ngModelCtrl.$validators.iban=()=>!this.ngModelCtrl.$viewValue||this.ibanChecker.isValid(e.$viewValue),this.ngModelCtrl.$validators.maxlength=()=>!this.ngModelCtrl.$viewValue||this.ngModelCtrl.$viewValue.length<=34}setInputs(e){e=e.find("input");this.countryInput=angular.element(e[0]),this.controlInput=angular.element(e[1]),this.bbanInput=angular.element(e[2])}initScope(){this.$scope.updateValue=()=>{this.setViewValue(this.$scope.countryCode.toUpperCase()+this.$scope.controlKey.toUpperCase()+this.$scope.bban.toUpperCase())},this.$scope.pasteIban=e=>{let t=e instanceof ClipboardEvent?e:e.originalEvent;this.setViewValue(t.clipboardData.getData("text/plain").replace(/ /g,"")),this.ngModelCtrl.$render(),t.target.blur()},this.$scope.selectInput=e=>{e.target.select()},this.$scope.setTouched=()=>{this.setTouched()},this.$scope.controlKeyMappings={8:()=>{this.$scope.controlKey||this.focusCountryInput()}},this.$scope.bbanMappings={8:()=>{this.$scope.bban||this.focusControlInput()}}}getViewValue(){return this.ngModelCtrl.$viewValue}setViewValue(e){this.ngModelCtrl.$setViewValue(e),this.ngModelCtrl.$setTouched()}setTouched(){this.ngModelCtrl.$setTouched()}focusCountryInput(){this.countryInput[0].focus(),this.countryInput[0].selectionStart=this.countryInput[0].selectionEnd}focusControlInput(){this.controlInput[0].focus(),this.controlInput[0].selectionStart=this.controlInput[0].selectionEnd}}t.IID="luidIbanController",t.$inject=["$scope","iban"],e.LuidIbanController=t,angular.module("lui.iban").controller(t.IID,t)}(e.iban||(e.iban={}))}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(){this.restrict="AE",this.templateUrl="lui/templates/iban/iban.view.html",this.require=[t.IID,"^ngModel"],this.controller=e.LuidIbanController.IID,this.scope={}}static factory(){return()=>new t}link(e,t,s,i){let l=i[0];i=i[1];l.setNgModelCtrl(i),l.setInputs(t)}}t.IID="luidIban",e.LuidIban=t,angular.module("lui.iban").directive(t.IID,t.factory())}(e.iban||(e.iban={}))}(lui=lui||{}),function(e){e.iban||(e.iban={})}(lui=lui||{}),function(e){e.iban||(e.iban={})}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(){this.restrict="A"}static factory(){return()=>new t}link(e,t,s){t.on("input",e=>{if(t[0].maxLength&&t[0].value.length===t[0].maxLength){let e=t.next();e.length&&e[0].select()}})}}t.IID="luidSelectNext",e.LuidSelectNext=t,angular.module("lui.iban").directive(t.IID,t.factory())}(e.iban||(e.iban={}))}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(){this.controller=s.IID,this.restrict="AE",this.scope={onCropped:"=",onCancelled:"=",croppingRatio:"=",croppingDisabled:"="},this.link=(i,l,e)=>{angular.element(l[0]).on("change",e=>{let s=e.currentTarget.files[0],t=new FileReader;t.onload=t=>{i.$apply(e=>{i.image=t.target.result,i.fileName=s.name,i.croppingDisabled?i.onCropped(i.image,i.fileName):i.openCropper(),null!=l[0]&&(l[0].value="")})},t.readAsDataURL(s)})}}static Factory(){var e=()=>new t;return e.$inject=[],e}}t.IID="luidImageCropper",e.LuidImageCropper=t;class s{constructor(s,e,i,l){s.image="",s.cropped="",s.openCropper=()=>{var e={templateUrl:"lui/templates/image-picker/image-cropper.modal.html",controller:r.IID,size:"desktop",resolve:{image:()=>s.image,fileName:()=>s.fileName,croppingRatio:()=>s.croppingRatio,cancelLabel:()=>l.cancelLabel}};let t=i.open(e);t.result.then(({image:e,cropped:t})=>{s.cropped=e;t=t?s.fileName.substr(0,s.fileName.lastIndexOf("."))+".png":s.fileName;s.onCropped(e,t)},()=>{s.onCancelled&&s.onCancelled()})}}}s.IID="luidImageCropperController",s.$inject=["$scope","moment","$uibModal","luisConfig"];class r{constructor(e,t,s,i,l,r,a){let n=!1;e.image=i,e.fileName=l,e.cancelLabel=a,e.croppingRatio=r,e.crop=()=>{n=!0,t.close({image:e.cropped,cropped:!0})},e.donotcrop=()=>{n=!0,t.close({image:e.image,cropped:!1})},e.cancel=()=>{n=!0,t.dismiss()},e.$on("modal.closing",e=>{n||e.preventDefault()})}}r.IID="luidImageCropperModalController",r.$inject=["$scope","$uibModalInstance","moment","image","croppingRatio","cancelLabel"],angular.module("lui.crop").directive(t.IID,t.Factory()),angular.module("lui.crop").controller(s.IID,s),angular.module("lui.crop").controller(r.IID,r)}(e.imagepicker||(e.imagepicker={}))}(lui=(lui=lui||{})||{}),function(s){!function(){"use strict";class e{constructor(){this.restrict="E",this.templateUrl="lui/templates/image-picker/image-picker.html",this.require=["ngModel",e.IID],this.scope={placeholderUrl:"@",croppingRatio:"=",croppingDisabled:"=",deleteEnabled:"=?",hideEditHint:"=",isDisabled:"="},this.controller=t.IID}static factory(){return()=>new e}link(e,t,s,i){var l=i[0];let r=i[1];r.setNgModelCtrl(l),r.setPlaceholder(e.placeholderUrl),r.setPopoverTrigger(t,e),r.setElements(t)}}e.IID="luidImagePicker";class t{constructor(s,i,t){this.$scope=s,this.$scope.deleteEnabled=null==this.$scope.deleteEnabled||this.$scope.deleteEnabled,s.setTouched=()=>{this.ngModelCtrl.$setTouched()},s.uploadNewImage=e=>{t(()=>{this.inputElement.click(),this.closePopover()})},s.onCropped=(e,t)=>{s.uploading=!0,i.postDataURI(e,t).then(e=>{s.uploading=!1,this.setViewValue(e),this.$scope.pictureStyle={"background-image":"url('"+e.href+"')"}},e=>{this.ngModelCtrl.$setTouched(),s.uploading=!1})},s.onCancelled=()=>{s.file=void 0,this.ngModelCtrl.$setTouched()},s.onDelete=()=>{this.setViewValue(void 0),s.file=void 0,this.$scope.pictureStyle={"background-image":"url('"+this.placeholder+"')"},this.closePopover()}}setNgModelCtrl(e){(this.ngModelCtrl=e).$render=()=>{this.$scope.file=this.getViewValue(),this.$scope.file&&this.$scope.file.href?this.$scope.pictureStyle={"background-image":"url('"+this.$scope.file.href+"')"}:this.$scope.pictureStyle={"background-image":"url('"+this.placeholder+"')"}}}setPlaceholder(e){this.placeholder=e||"/static/common/images/placeholder-pp.png"}setPopoverTrigger(e,t){this.popoverController=new s.popover.ClickoutsideTrigger(e,t,()=>{this.closePopover()}),t.popover={isOpen:!1},t.togglePopover=e=>{e.preventDefault(),t.file&&t.file.href&&t.deleteEnabled?this.togglePopover(e):this.$scope.uploadNewImage(e)}}setElements(e){this.inputElement=e.find("input")[0]}togglePopover(e){this.$scope.popover.isOpen?this.closePopover():this.openPopover(e)}closePopover(){this.popoverController&&this.popoverController.close()}openPopover(e){this.popoverController&&this.popoverController.open(e)}getViewValue(){return this.ngModelCtrl.$viewValue}setViewValue(e){this.ngModelCtrl.$setTouched(),this.ngModelCtrl.$setViewValue(e),this.$scope.file=e}}t.IID="luidImagePickerController",t.$inject=["$scope","uploaderService","$timeout"],angular.module("lui.crop").directive(e.IID,e.factory()),angular.module("lui.crop").controller(t.IID,t)}(s.imagepicker||(s.imagepicker={}))}(lui=lui||{}),function(e){!function(){"use strict";angular.module("lui.crop").config(["$translateProvider",function(e){e.translations("en",{LUIIMGPICKER_UPLOAD_IMAGE:"change picture",LUIIMGPICKER_MODIFY_IMAGE:"modify picture",LUIIMGPICKER_DELETE_IMAGE:"delete picture",LUIIMGCROPPER_CROP:"Crop",LUIIMGCROPPER_DO_NOT_CROP:"Do not crop"}),e.translations("de",{}),e.translations("es",{}),e.translations("fr",{LUIIMGPICKER_UPLOAD_IMAGE:"changer l'image",LUIIMGPICKER_MODIFY_IMAGE:"modifier l'image",LUIIMGPICKER_DELETE_IMAGE:"supprimer l'image",LUIIMGCROPPER_CROP:"Recadrer",LUIIMGCROPPER_DO_NOT_CROP:"Ne pas recadrer"}),e.translations("it",{}),e.translations("nl",{})}])}(e.imagepicker||(e.imagepicker={}))}(lui=lui||{}),function(e){!function(e){"use strict";class a{constructor(e,t){this.message=e,this.details=t}}class t{constructor(e,t,s){this.duration=e,this.templateUrl=t,this.message=s}}class s extends t{constructor(e){super(2e4,"lui/templates/notify-service/error.html",e)}}class i extends t{constructor(e){super(1e4,"lui/templates/notify-service/warning.html",e)}}class l extends t{constructor(e){super(5e3,"lui/templates/notify-service/success.html",e)}}class n extends t{constructor(e,t){super(864e5,"lui/templates/notify-service/loading.html",t),this.scope=e}}class r{constructor(e,t,s,i,l,r,a){this.cgNotify=e,this.$q=t,this.$log=s,this.$rootScope=i,this.$timeout=l,this.$uibModal=r,this.luisConfig=a,this.cgNotify.config({container:this.luisConfig.parentElt,startTop:this.luisConfig.startTop})}error(e,t){this.$log.error(new a(e,t)),this.cgNotify(new s(e))}warning(e,t){this.$log.warn(new a(e,t)),this.cgNotify(new i(e))}success(e,t){this.$log.log(new a(e,t)),this.cgNotify(new l(e))}alert(e,t,s){return this.openModal("lui/templates/notify-service/alert.html",e,t||this.luisConfig.okLabel,s||this.luisConfig.cancelLabel,!1)}confirm(e,t,s){return this.openModal("lui/templates/notify-service/confirm.html",e,t||this.luisConfig.okLabel,s||this.luisConfig.cancelLabel,!this.luisConfig.canDismissConfirm)}loading(e,t,s){let i=this.$rootScope.$new(!0),l=(i.loading=!0,i.calloutClass="light",i.message=t,this.cgNotify(new n(i,t))),r=e=>{this.$timeout(()=>{l.close(),i.$destroy()},e)};s&&(i.canCancel=!0,i.cancel=()=>{this.$log.warn(new a(t,"user cancelled")),s(),r(0)}),e.then(e=>{i.message=e,i.calloutClass="green",i.loading=!1,r(5e3)},e=>{i.message=e,i.calloutClass="red",i.loading=!1,this.$log.error(new a(t,"")),r(2e4)},e=>{i.message=e})}openModal(e,t,s,i,l){return this.$uibModal.open({templateUrl:e,controller:o.IID,size:"mobile",resolve:{message:()=>t,okLabel:()=>s,cancelLabel:()=>i,preventDismiss:()=>l}}).result}}r.IID="luisNotify",r.$inject=["notify","$q","$log","$rootScope","$timeout","$uibModal","luisConfig"],e.NotifyService=r;class o{constructor(e,t,s,i,l,r){e.message=s,e.okLabel=i,e.cancelLabel=l,e.ok=()=>{this.doClose=!0,t.close(!0)},e.cancel=()=>{this.doClose=!0,t.close(!1)},r&&e.$on("modal.closing",e=>{this.doClose||e.preventDefault()})}}o.IID="notifyModalController",o.$inject=["$scope","$uibModalInstance","message","okLabel","cancelLabel","preventDismiss"],angular.module("lui.notify").service(r.IID,r),angular.module("lui.notify").controller(o.IID,o)}(e.notify||(e.notify={}))}(lui=(lui=lui||{})||{}),function(e){!function(){"use strict";class e{constructor(e,t,s,i){this.totalRequests=0,this.completedRequests=0,this.request=e=>(this.isCached(e)||this.startRequest(e.method),e),this.requestError=e=>(this.startRequest("GET"),this.$q.reject(e)),this.response=e=>(e&&!this.isCached(e.config)&&this.endRequest(this.extractMethod(e)),e),this.responseError=e=>(this.endRequest("GET"),this.$q.reject(e)),this.isCached=e=>{let t;var s=this.$cacheFactory.get("$http"),s=void 0!==(t=!e.cache||!1===e.cache||"GET"!==e.method&&"JSONP"!==e.method?t:angular.isObject(e.cache)?e.cache:s)&&void 0!==t.get(e.url);return void 0!==e.cached&&s!==e.cached?e.cached:e.cached=s},this.extractMethod=e=>{try{return e.config.method}catch(e){return"GET"}},this.startRequest=e=>{this.progressBarService.isListening()?-1<this.progressBarService.getHttpRequestMethods().indexOf(e)&&(0===this.totalRequests&&this.progressBarService.start(),this.totalRequests++):(this.totalRequests=0,this.completedRequests=0)},this.setComplete=()=>{this.completeTimeout&&this.$timeout.cancel(this.completeTimeout),this.completeTimeout=this.$timeout(()=>{this.progressBarService.complete(),this.totalRequests=0,this.completedRequests=0},200)},this.endRequest=e=>{this.progressBarService.isListening()&&-1<this.progressBarService.getHttpRequestMethods().indexOf(e)&&(this.completedRequests++,this.completedRequests>=this.totalRequests&&this.setComplete())},this.$q=e,this.$cacheFactory=t,this.$timeout=s,this.progressBarService=i}}e.IID="luiHttpInterceptor",e.$inject=["$q","$cacheFactory","$timeout","luisProgressBar"],angular.module("lui").service(e.IID,e)}(e.progressbar||(e.progressbar={}))}(lui=lui||{}),function(e){!function(){"use strict";class e{constructor(e,t,s,i,l,r){this.latencyThreshold=200,this.httpResquestListening=!1,this.status=0,this.progressBarTemplate='<div class="lui slim progressing progress progress-bar"><div class="indicator" data-percentage="0" style="width: 0%;"></div></div>',this.$document=e,this.$window=t,this.$timeout=s,this.$interval=i,this.$log=l,this.luisConfig=r}addProgressBar(e="primary"){this.progressbarEl&&this.progressbarEl.remove(),this.progressbarEl=angular.element(this.progressBarTemplate),this.progressbarEl.addClass(e),this.luisConfig.parentElt.append(this.progressbarEl)}startListening(e){this.httpResquestListening=!0,this.httpRequestMethods=e||["GET"],this.setStatus(0)}stopListening(){this.httpResquestListening=!1,this.setStatus(0)}isListening(){return this.httpResquestListening}getHttpRequestMethods(){return this.httpRequestMethods}start(){this.isStarted||(this.isStarted=!0,this.$timeout.cancel(this.completeTimeout),this.$interval.cancel(this.currentPromiseInterval),this.show(),this.currentPromiseInterval=this.$interval(()=>{var e;isNaN(this.status)?(this.$interval.cancel(this.currentPromiseInterval),this.setStatus(0),this.hide()):30<(e=100-this.status)?this.setStatus(this.status+.5*Math.sqrt(e)):this.setStatus(this.status+.15*Math.pow(1-Math.sqrt(e),2))},this.latencyThreshold))}complete(){this.$interval.cancel(this.currentPromiseInterval),this.isStarted=!1,this.httpResquestListening=!1,this.setStatus(100),this.hide()}hide(){this.$timeout(()=>{this.progressbarEl&&(this.progressbarEl.removeClass("in"),this.progressbarEl.addClass("out"),this.setStatus(0))},300)}show(){this.progressbarEl&&(this.progressbarEl.removeClass("out"),this.progressbarEl.addClass("in"),this.setStatus(0))}setStatus(e){this.status=e,this.progressbarEl&&(this.progressbarEl.children().css("width",this.status+"%"),this.progressbarEl.children().attr("data-percentage",this.status))}}e.IID="luisProgressBar",e.$inject=["$document","$window","$timeout","$interval","$log","luisConfig"],angular.module("lui").service(e.IID,e)}(e.progressbar||(e.progressbar={}))}(lui=(lui=lui||{})||{}),function(e){!function(e){"use strict";(e=e.FilterType||(e.FilterType={}))[e.NONE=0]="NONE",e[e.TEXT=1]="TEXT",e[e.SELECT=2]="SELECT",e[e.MULTISELECT=3]="MULTISELECT"}(e.tablegrid||(e.tablegrid={}))}(lui=lui||{}),function(e){!function(u){"use strict";class e{constructor(l,r,e,t){let s=0,i=(r.isSelectable=angular.isDefined(r.selectable),r.internalRowClick=(e,t)=>{let s=e.target,i=!1;for(;!i&&s.nodeName!==e.currentTarget.nodeName;)i=!!s.href||"checkbox"===s.type,s=s.parentElement;i||r.onRowClick({row:t})},t=>(t.tree.children.length||t.subChildren++,t.tree.children.forEach(e=>{e=i({depth:t.depth+1,tree:e,subChildren:0,subDepth:0});t.subChildren+=e.subChildren,t.subDepth=Math.max(t.subDepth,e.subDepth)}),t.tree.children.length?t.subDepth++:r.colDefinitions.push(t.tree.node),t.tree.node&&(t.tree.node.rowspan=s-t.depth-t.subDepth,t.tree.node.colspan=t.subChildren,t.tree.children.length||t.tree.node.filterType!==u.FilterType.NONE||t.tree.node.rowspan++,r.headerRows[t.depth]?r.headerRows[t.depth].push(t.tree.node):r.headerRows[t.depth]=[t.tree.node]),t)),a=e=>{let t=0;return e.children.forEach(e=>{t=Math.max(t,a(e))}),t+1};r.initFilter=()=>{r.filters=[],_.each(r.colDefinitions,(s,i)=>{_.each(r.datas,t=>{if(r.filters[i]||(r.filters[i]={header:s,selectValues:[],currentValues:[]}),s.filterType===u.FilterType.SELECT||s.filterType===u.FilterType.MULTISELECT){let e=s.getValue(t)+"";t=(e=s.getFilterValue?s.getFilterValue(t)+"":e).split("|");_.each(t,e=>{_.contains(r.filters[i].selectValues,e)||r.filters[i].selectValues.push(e)})}}),r.filters[i].selectValues=_.sortBy(r.filters[i].selectValues,e=>e?e.toLowerCase():"")})};var n;let o=()=>{var e=_.filter(r.filteredAndOrderedRows,e=>e._luiTableGridRow.isChecked).length;return 0===e?"":e===r.filteredAndOrderedRows.length?"checked":e<r.filteredAndOrderedRows.length?"partial":""};r.updateFilteredRows=()=>{r.isSelectable&&(r.allChecked.value=!1,_.each(r.filteredAndOrderedRows,e=>{e._luiTableGridRow.isChecked=!1}),r.masterCheckBoxCssClass=o());let e=_.chain(r.datas).each(e=>{e._luiTableGridRow.isInFilteredDataset=!1}).filter(e=>{let i=!0;return r.filters.forEach(s=>{if(s.header&&s.currentValues[0]&&""!==s.currentValues[0]){let t=(s.header.getValue(e)+"").toLowerCase();s.header.getFilterValue&&(t=(s.header.getFilterValue(e)+"").toLowerCase()),_.some(s.currentValues,e=>s.header.filterType===u.FilterType.SELECT||s.header.filterType===u.FilterType.MULTISELECT?-1!==t.indexOf("|")?-1!==t.split("|").indexOf(e.toLowerCase()):t===e.toLowerCase():-1!==l("luifStripAccents")(t).indexOf(l("luifStripAccents")(e.toLowerCase())))||(i=!1)}}),i}).each(e=>{e._luiTableGridRow.isInFilteredDataset=!0});r.filteredAndOrderedRows=e.value(),r.orderBySelectedHeader(),r.updateViewAfterFiltering()},r.orderBySelectedHeader=()=>{r.selected&&r.selected.orderBy&&(r.filteredAndOrderedRows=_.sortBy(r.filteredAndOrderedRows,e=>{let t=r.selected.orderBy.getValue(e);return t=null!=r.selected.orderBy.getOrderByValue?r.selected.orderBy.getOrderByValue(e):t})),r.filteredAndOrderedRows=r.selected.reverse?r.filteredAndOrderedRows.reverse():r.filteredAndOrderedRows},r.updateOrderedRows=e=>{e===r.selected.orderBy?r.selected.reverse?(r.selected.orderBy=null,r.selected.reverse=!1):r.selected.reverse=!0:(r.selected.orderBy=e,r.selected.reverse=!1),r.orderBySelectedHeader(),r.updateViewAfterOrderBy()},r.onMasterCheckBoxChange=()=>{_.some(r.filteredAndOrderedRows,e=>!e._luiTableGridRow.isChecked)?"partial"===r.masterCheckBoxCssClass?_.each(r.filteredAndOrderedRows,e=>{e._luiTableGridRow.isChecked=!1}):_.each(r.filteredAndOrderedRows,e=>{e._luiTableGridRow.isChecked=!0}):_.each(r.filteredAndOrderedRows,e=>{e._luiTableGridRow.isChecked=!1}),r.masterCheckBoxCssClass=o()},r.onCheckBoxChange=()=>{r.masterCheckBoxCssClass=o(),r.masterCheckBoxCssClass||(r.allChecked.value=!1),_.some(r.filteredAndOrderedRows,e=>e._luiTableGridRow.isChecked)&&(r.allChecked.value=!0)},r.FilterTypeEnum={NONE:u.FilterType.NONE,TEXT:u.FilterType.TEXT,SELECT:u.FilterType.SELECT,MULTISELECT:u.FilterType.MULTISELECT},r.headerRows=[],r.bodyRows=[],r.colDefinitions=[],r.allChecked={value:!1},s=a(r.header),i({depth:0,subChildren:0,subDepth:0,tree:r.header}),r.existFixedRow=_.some(r.colDefinitions,e=>e.fixed),r.selected={orderBy:null,reverse:!1},r.defaultOrder&&("-"!==(n=r.defaultOrder.substr(0,1))&&"+"!==n||(r.defaultOrder=r.defaultOrder.substr(1),r.selected.reverse="-"===n),n=_.find(r.colDefinitions,e=>e.label===r.defaultOrder),r.selected.orderBy=n||null),_.each(r.datas,e=>{e._luiTableGridRow={isInFilteredDataset:!0},r.isSelectable&&(e._luiTableGridRow.isChecked=!1)})}}e.IID="luidTableGridController",e.$inject=["$filter","$scope","$translate","$timeout"],u.LuidTableGridController=e,angular.module("lui.tablegrid").controller(e.IID,e)}(e.tablegrid||(e.tablegrid={}))}(lui=lui||{}),function(e){!function(e){"use strict";class L{static isTypeExisting(e){return e===L.GLOBAL||e===L.BODY}}L.GLOBAL="global",L.BODY="body",e.LuidTableGridHeightType=L;class A{constructor(e){this.controller="luidTableGridController",this.restrict="AE",this.scope={header:"=",height:"@",datas:"=*",selectable:"@",defaultOrder:"@",onRowClick:"&",heightType:"@"},this.templateUrl="lui/templates/table-grid/table-grid.html",this.link=(I,M,w)=>{this.$timeout(()=>{let l=angular.element(M[0].querySelector(".lui.tablegrid"))[0],r=l.querySelectorAll("table"),a=l.querySelectorAll("thead"),n=l.querySelectorAll("tbody"),o=l.querySelector(".locked.columns"),t=o?o.querySelector(".holder .virtualscroll"):void 0,u=o?o.querySelector(".holder"):void 0,d=l.querySelector(".scrollable.columns"),c=d.querySelector(".virtualscroll");w.selectable=angular.isDefined(w.selectable);let p=(()=>{let e=document.createElement("p"),t=(e.style.width="100%",e.style.height="200px",document.createElement("div"));t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var s=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return s===i&&(i=t.clientWidth),document.body.removeChild(t),s-i})(),h=w.height?parseFloat(w.height):A.defaultHeight,s=L.isTypeExisting(w.heightType)?w.heightType:L.BODY,i=32,m=3*Math.round(h/i),e,g=0,f=(I.visibleRows=[],0),v=Math.max(a[0].offsetHeight,a[1]?a[1].offsetHeight:0),y=()=>{if(!r[1])return 0;let e=0;for(var t of a[1].querySelectorAll("tr:first-child th.locked"))e+=t.offsetWidth;return e+1},E=()=>{v=Math.max(a[0].offsetHeight,a[1]?a[1].offsetHeight:0);var e=h;e-=s===L.GLOBAL?v:0,d.style.maxHeight=e+"px",l.style.paddingTop=v+"px",r[1]&&(r[1].style.marginTop=v+f+"px")},b,C=()=>{E();var e,t,s=d.clientHeight<Math.max(b,c.clientHeight)?l.clientWidth-p:l.clientWidth;for(e of a)e.style.minWidth=s+"px";for(t of r)t.style.minWidth=a[0].offsetWidth+"px";var i=y();i&&(u.style.maxHeight=n[0].clientWidth>s?+h+v-p+"px":+h+v+"px",o.style.width=i+"px",d.style.marginLeft=i+"px",c.style.marginLeft=-i+"px")},$=e=>{(b=(I.filteredAndOrderedRows.length-e)*i)>h?(c.style.height=b+"px",t&&(t.style.height=b+"px")):(c.style.height=h+"px",t&&(t.style.height=h+"px"))},D=()=>{if(I.filteredAndOrderedRows.length<=200)return I.visibleRows=I.filteredAndOrderedRows,void $(0);var e=g<d.scrollTop,t=_.last(I.visibleRows)===_.last(I.filteredAndOrderedRows);e&&t||(e=Math.floor(d.scrollTop/i),t=Math.min(e+m,m),f=e*i,I.visibleRows=I.filteredAndOrderedRows.slice(e,e+t),(I.existFixedRow||w.selectable)&&(r[1].style.marginTop=v+f+"px"),r[0].style.marginTop=f+"px",c.style.marginTop=f+"px",$(e))};I.updateViewAfterOrderBy=()=>{D(),this.$timeout(()=>{E()},0)},I.updateViewAfterFiltering=()=>{d.scrollTop=0,r[0].style.marginTop="0px",c.style.marginTop="0px",(I.existFixedRow||w.selectable)&&(u.scrollTop=0,r[1].style.marginTop="0px"),D(),this.$timeout(()=>{C()},0)},I.$watchCollection("datas",()=>{I.datas&&(I.filteredAndOrderedRows=I.datas,I.initFilter(),null!==I.selected.orderBy&&I.orderBySelectedHeader(),_.each(I.datas,e=>{e._luiTableGridRow={isInFilteredDataset:!0}}),I.updateViewAfterFiltering())}),window.addEventListener("resize",()=>{this.$timeout.cancel(e),e=this.$timeout(()=>{C()},100)}),d.addEventListener("scroll",e=>{(I.existFixedRow||w.selectable)&&(u.scrollTop=d.scrollTop),a[0].style.left=-d.scrollLeft+"px",I.visibleRows.length!==I.filteredAndOrderedRows.length&&(D(),I.$digest()),g=d.scrollTop})},0)},this.$timeout=e}static Factory(){var e=e=>new A(e);return e.$inject=["$timeout"],e}}A.defaultHeight=20,A.IID="luidTableGrid",e.LuidTableGrid=A,angular.module("lui.tablegrid").directive(A.IID,A.Factory())}(e.tablegrid||(e.tablegrid={}))}(lui=lui||{}),function(e){!function(){"use strict";angular.module("lui.tablegrid").config(["$translateProvider",function(e){e.translations("en",{SELECT_ITEM:"Select an item",SELECT_ITEMS:"Select items"}),e.translations("de",{}),e.translations("es",{}),e.translations("fr",{SELECT_ITEM:"Sélectionnez un élément",SELECT_ITEMS:"Sélectionnez des éléments"}),e.translations("it",{}),e.translations("nl",{})}])}(e.tablegrid||(e.tablegrid={}))}(lui=lui||{}),function(e){e.tablegrid||(e.tablegrid={})}(lui=lui||{}),function(e){!function(e){"use strict";e.AVAILABLE_LANGUAGES=["en","fr","de","es","it","nl","pt"],e.LANGUAGES_TO_CODE={en:1033,de:1031,es:1034,fr:1036,it:1040,nl:2067,pt:2070},e.CODES_TO_LANGUAGES={1033:"en",1031:"de",1034:"es",1036:"fr",1040:"it",2067:"nl",2070:"pt"};e.CulturedList=class{constructor(e){this.culture=e,this.originalId=void 0,this.values=new Array}}}(e.translate||(e.translate={}))}(lui=lui||{}),function(e){!function(a){"use strict";class e{constructor(r,l,s){(this.$scope=r).currentCulture=l.preferredLanguage(),r.currentCulture||(r.currentCulture="en"),r.cultures=a.AVAILABLE_LANGUAGES;var e=_.indexOf(r.cultures,r.currentCulture);-1!==e&&(r.cultures.splice(e,1),r.cultures.unshift(r.currentCulture)),r.selectedCulture=r.currentCulture,r.values={},r.selectCulture=e=>{r.selectedCulture=e},r.addValue=()=>{_.each(a.AVAILABLE_LANGUAGES,e=>{r.values[e].values.push({value:""})})};const i=t=>{_.each(a.AVAILABLE_LANGUAGES,e=>{r.values[e].values.splice(t,1)}),0===r.values[a.AVAILABLE_LANGUAGES[0]].values.length&&_.each(a.AVAILABLE_LANGUAGES,e=>{r.values[e].values.push({value:""})}),r.onInputValueChanged()};r.deleteValue=t=>{void 0===r.deletionCallback?i(t):r.deletionCallback().then(e=>{e&&i(t)})},r.isAddValueDisabled=()=>!_.some(a.AVAILABLE_LANGUAGES,e=>{e=this.$scope.values[e].values;return""!==e[e.length-1].value}),r.onPaste=(e,t)=>{if(!r.isDisabled){const i=e instanceof ClipboardEvent?e:e.originalEvent;var s=_.reject(i.clipboardData.getData("text/plain").split(/\r\n|\r|\n/g),e=>""===e);if(1!==s.length){for(let e=0;e<s.length;++e,++t)r.values[r.selectedCulture].values[t]={value:s[e]};const l=r.values[r.selectedCulture].values.length;_.chain(a.AVAILABLE_LANGUAGES).reject(e=>e===r.selectedCulture).filter(e=>r.values[e].values.length<l).each(t=>{for(let e=r.values[t].values.length;e<l;++e)r.values[t].values.push({value:""})}),r.onInputValueChanged(),e.preventDefault(),i.target.blur()}}},r.addValueAndFocus=()=>{const e=r.values[r.selectedCulture].values.length-1;r.addValue(),s(()=>document.getElementById(r.getUniqueId(r.selectedCulture,1+e)).focus())},r.addValueOnEnter={13:e=>{let t=Number(e.target.id.split("_")[2]);t===r.values[r.selectedCulture].values.length-1?r.isAddValueDisabled()||(t++,r.addValue(),r.$apply(),s(()=>document.getElementById(r.getUniqueId(r.selectedCulture,t)).focus())):(t++,document.getElementById(r.getUniqueId(r.selectedCulture,t)).focus(),r.$apply()),e.preventDefault()}},r.getPlaceholder=(e,t)=>{var s=r.values[r.selectedCulture].values[t].value;if(s)return s;s=r.values[r.currentCulture].values[t].value;if(s)return r.isDisabled?"":s;for(let e=0;e<r.cultures.length;e++){var i=r.cultures[e],i=r.values[i].values[t].value;if(i)return r.isDisabled?"":i}return r.isDisabled?"":l.instant("LUID_TRANSLATIONSLIST_INPUT_VALUE")},r.getUniqueId=(e,t)=>`${e}_${r.uniqueId}_`+t}}e.IID="luidTranslationsList",e.$inject=["$scope","$translate","$timeout"],a.LuidTranslationsListController=e,angular.module("lui.translate").controller(e.IID,e),angular.module("lui.translate").config(["$translateProvider",function(e){e.translations("en",{LUID_TRANSLATIONSLIST_ADD_VALUE:"Add new value",LUID_TRANSLATIONSLIST_INPUT_VALUE:"Input a value"}),e.translations("fr",{LUID_TRANSLATIONSLIST_ADD_VALUE:"Ajouter une nouvelle valeur",LUID_TRANSLATIONSLIST_INPUT_VALUE:"Saisir une valeur"})}])}(e.translate||(e.translate={}))}(lui=lui||{}),function(e){!function(r){"use strict";class a{constructor(){this.restrict="E",this.templateUrl="lui/templates/translations-list/translations-list.html",this.require=["ngModel",a.IID],this.scope={mode:"@",isDisabled:"=ngDisabled",deletionCallback:"&?"},this.controller=r.LuidTranslationsListController.IID}static factory(){return()=>new a}static toModel(e,t){let s;return s="lucca"===t?a.toLuccaModel(e):void 0}static toLuccaModel(l){let t=new Array,s=-1,e=_.filter(r.AVAILABLE_LANGUAGES,e=>(l[e].values.length>s&&(s=l[e].values.length),_.some(l[e].values,e=>""!==e.value)));if(0!==e.length){for(let e=0;e<s;++e)t.push({id:void 0,culturedLabels:new Array});let i=0;return _.each(t,s=>{_.each(e,e=>{var t;""!==l[e].values[i].value&&(t=l[e].values[i],s.culturedLabels.push({id:t.originalLuccaCulturedLabelId,translationId:t.originalLuccaTranslationId,cultureCode:r.LANGUAGES_TO_CODE[e],value:t.value}),!s.id&&t.originalLuccaTranslationId&&(s.id=t.originalLuccaTranslationId))}),++i}),t=_.reject(t,e=>0===e.culturedLabels.length)}}static parse(e,t){let s;return s="lucca"===t?a.parseLucca(e):void 0}static parseLucca(e){let s=a.getEmptyCulturedLists();return null!=e&&e.length?_.each(e,e=>{if(_.each(e.culturedLabels,e=>{var t=r.CODES_TO_LANGUAGES[e.cultureCode];s[t].values.push({value:e.value,originalLuccaCulturedLabelId:e.id,originalLuccaTranslationId:e.translationId})}),0<e.culturedLabels.length){let t=s[r.CODES_TO_LANGUAGES[e.culturedLabels[0].cultureCode]].values.length;_.each(r.AVAILABLE_LANGUAGES,e=>{s[e].values.length!==t&&s[e].values.push({value:""})})}}):_.each(r.AVAILABLE_LANGUAGES,e=>{s[e].values.push({value:""})}),s}static getEmptyCulturedLists(){let t={};return _.each(r.AVAILABLE_LANGUAGES,e=>{t[e]=new r.CulturedList(e)}),t}link(t,e,s,i){let l=i[0],r=s.mode;r=r||"lucca",t.uniqueId=(Math.floor(9e3*Math.random())+1).toString(),t.onInputValueChanged=()=>{l.$setViewValue(a.toModel(t.values,r)),l.$setTouched()},l.$render=()=>{var e=a.parse(l.$viewValue,r);e&&(t.values=e)}}}a.IID="luidTranslationsList",angular.module("lui.translate").directive(a.IID,a.factory())}(e.translate||(e.translate={}))}(lui=lui||{}),function(e){e.translate||(e.translate={})}(lui=lui||{}),function(e){!function(){"use strict";class t{constructor(e){this.restrict="A",this.require=["uiSelect"],this.$timeout=e}static factory(){var e=e=>new t(e);return e.$inject=["$timeout"],e}link(e,t,s,i){let l=i[0];s.openOn&&e.$on(s.openOn,()=>{this.$timeout(()=>{l.activate()})})}}t.IID="openOn",angular.module("lui.translate").directive(t.IID,t.factory())}(e.userpicker||(e.userpicker={}))}(lui=lui||{}),function(e){e.userpicker||(e.userpicker={})}(lui=lui||{}),function(e){!function(r){"use strict";const a=[{translationKey:"LUIDUSERPICKER_DEPARTMENT",name:"department.name",icon:"location"},{translationKey:"LUIDUSERPICKER_LEGALENTITY",name:"legalEntity.name",icon:"tree list"},{translationKey:"LUIDUSERPICKER_MAIL",name:"mail",icon:"email"}];r.MAGIC_PAGING=15,r.MAX_SEARCH_LIMIT=1e4;class e{constructor(e,t,s){this.$scope=e,this.$q=t,this.userPickerService=s,this.userPickerService.setCustomHttpService(e.customHttpService),this.$scope.lastPagingOffset=0,this.$scope.users=new Array,this.userPickerService.getMyId().then(e=>{this.$scope.myId=e,this.refresh().then(e=>{this.initializeScope()})})}initializeScope(){this.$scope.$watch("displayMeFirst",(e,t)=>{var s;this.$scope.displayMeFirst&&e&&(-1!==(e=_.findIndex(this.$scope.users,e=>e.id===this.$scope.myId))?(s=this.$scope.users[e],this.$scope.users.splice(e,1),this.$scope.users.unshift(s)):this.userPickerService.getMe().then(e=>{this.tidyUp([e]).then(e=>{this.$scope.users.unshift(e[0])})}))}),this.$scope.$watch("showFormerEmployees",(e,t)=>{void 0!==this.$scope.showFormerEmployees&&e!==t&&(this.$scope.$broadcast("toggleFormerEmployees"),this.resetUsers(),this.refresh(this.clue))}),this.$scope.$watchCollection("bypassOperationsFor",(e,t)=>{void 0!==e&&this.userPickerService.getUsersByIds(e).then(e=>{this.tidyUp(e).then(e=>{_.each(e,t=>{void 0===_.find(this.$scope.users,e=>e.id===t.id)&&this.$scope.users.push(t)})})})}),this.$scope.$watch("legalEntityIds",(e,t)=>{void 0!==this.$scope.legalEntityIds&&e!==t&&(this.resetUsers(),this.refresh(this.clue))}),this.$scope.$watchGroup(["appId","operations"],(e,t)=>{angular.isDefined(e)&&angular.isDefined(e[0])&&angular.isDefined(e[1])&&0<e[1].length&&e[0]!==t[0]&&!_.isEqual(e[1],t[1])&&(this.resetUsers(),this.refresh())}),this.$scope.find=e=>{this.clue=e,this.resetUsers(),this.refresh(e)},this.$scope.loadMore=()=>{this.$scope.loadingMore||(this.$scope.lastPagingOffset+=r.MAGIC_PAGING,this.$scope.loadingMore=!0,this.refresh().then(()=>{this.$scope.loadingMore=!1}))}}tidyUp(e,t=0){let s=new Array,i={},l={},r=(_.each(e,e=>{e.hasLeft=!!e.dtContractEnd&&moment(e.dtContractEnd).isBefore(moment().startOf("day"))}),this.$scope.customInfo&&_.each(e,e=>{e.info=this.$scope.customInfo(e)}),this.$scope.customInfoAsync&&_.each(e,e=>{i[e.id.toString()]=s.push(this.$scope.customInfoAsync(e))-1}),this.userPickerService.getHomonyms(e));if(r&&0<r.length){let t=this.$scope.homonymsProperties&&0<this.$scope.homonymsProperties.length?this.$scope.homonymsProperties:a;_.each(r,e=>{l[e.id]=s.push(this.userPickerService.getAdditionalProperties(e,t))-1})}return this.$q.all(s).then(s=>(r&&0<r.length&&(_.each(e,e=>{angular.isDefined(l[e.id])&&(e.additionalProperties=s[l[e.id.toString()]],e.hasHomonyms=!0)}),e=this.userPickerService.reduceAdditionalProperties(e)),this.$scope.customInfoAsync&&_.each(e,e=>{var t=i[e.id.toString()];angular.isDefined(e.info)&&""!==e.info?e.info=e.info+" "+s[t]:e.info=s[t]}),e))}refresh(t=""){return this.getUsers(t).then(e=>{this.tidyUpAndAssign(e,t)})}getUsers(i=""){let t=r.MAGIC_PAGING,l=this.$scope.lastPagingOffset,e=t,s=l;this.$scope.customFilter&&(e=r.MAX_SEARCH_LIMIT,s=0);return this.$q.all([this.userPickerService.getUsers(this.getFilter(i),e,s).then(e=>this.$scope.customFilter?_.chain(e).filter(e=>this.$scope.customFilter(e)).rest(l).first(t).value():e),this.userPickerService.getMe()]).then(e=>{let t=e[0];var s,e=e[1];return l||(!i&&this.$scope.displayAllUsers&&t.unshift({id:-1,firstName:"",lastName:"",dtContractStart:"",employeeNumber:""}),!i&&this.$scope.displayMeFirst&&(-1!==(s=_.findIndex(t,e=>e.id===this.$scope.myId))&&t.splice(s,1),t.unshift(e))),t})}tidyUpAndAssign(e,t){return this.tidyUp(e,t).then(e=>(this.$scope.users=this.$scope.users||[],this.$scope.users.push(..._.filter(e,t=>!_.any(this.$scope.users,e=>e.id===t.id))),this.$scope.users))}resetUsers(){this.$scope.users=[],this.$scope.lastPagingOffset=0}getFilter(e){let t=this.$scope;return"formerEmployees="+(t.showFormerEmployees?t.showFormerEmployees.toString():"false")+(t.appId&&t.operations&&0<t.operations.length?"&appinstanceid="+t.appId+"&operations="+t.operations.join(","):"")+(e?"&clue="+e:"")+"&searchByEmployeeNumber="+(t.searchByEmployeeNumber?"true":"false")+(t.legalEntityIds&&0<t.legalEntityIds.length?"&legalEntityIds="+t.legalEntityIds.join(","):"")}}e.IID="luidUserPickerController",e.$inject=["$scope","$q","userPickerService"],r.LuidUserPickerController=e,angular.module("lui").controller(e.IID,e),angular.module("lui").filter("luifHighlight",["$filter","$translate",function(r,a){return function(e,t,s,i){let l=r("highlight");return(s?'<span class="lui label">'+s+"</span>":"")+(i?"<i>"+a.instant(i)+"</i> ":"")+"<span>"+l(e,t)+"</span>"}}]),angular.module("lui.translate").config(["$translateProvider",function(e){e.translations("en",{LUIDUSERPICKER_FORMEREMPLOYEE:"Left on {{dtContractEnd | luifMoment : 'LL'}}",LUIDUSERPICKER_NORESULTS:"No results",LUIDUSERPICKER_ERR_GET_USERS:"Error while loading users",LUIDUSERPICKER_OVERFLOW:"{{cnt}} displayed results of {{all}}",LUIDUSERPICKER_DEPARTMENT:"Department",LUIDUSERPICKER_LEGALENTITY:"Legal entity",LUIDUSERPICKER_EMPLOYEENUMBER:"Employee number",LUIDUSERPICKER_MAIL:"Email",LUIDUSERPICKER_ME:"Me:",LUIDUSERPICKER_ALL:"All users"}),e.translations("de",{LUIDUSERPICKER_FORMEREMPLOYEE:"Verließ die {{dtContractEnd | luifMoment : 'LL'}}",LUIDUSERPICKER_NORESULTS:"Keine Ergebnisse",LUIDUSERPICKER_ERR_GET_USERS:"Fehler",LUIDUSERPICKER_OVERFLOW:"Es werden {{cnt}} auf {{all}} Benutzernamen",LUIDUSERPICKER_DEPARTMENT:"Abteilung",LUIDUSERPICKER_LEGALENTITY:"Rechtsträger",LUIDUSERPICKER_EMPLOYEENUMBER:"Betriebsnummer",LUIDUSERPICKER_MAIL:"E-mail",LUIDUSERPICKER_ME:"Mir:",LUIDUSERPICKER_ALL:"Alle Benutzer"}),e.translations("fr",{LUIDUSERPICKER_FORMEREMPLOYEE:"Parti(e) le {{dtContractEnd | luifMoment : 'LL'}}",LUIDUSERPICKER_NORESULTS:"Aucun résultat",LUIDUSERPICKER_ERR_GET_USERS:"Erreur lors de la récupération des utilisateurs",LUIDUSERPICKER_OVERFLOW:"{{cnt}} résultats affichés sur {{all}}",LUIDUSERPICKER_DEPARTMENT:"Service",LUIDUSERPICKER_LEGALENTITY:"Entité légale",LUIDUSERPICKER_EMPLOYEENUMBER:"Matricule",LUIDUSERPICKER_MAIL:"Email",LUIDUSERPICKER_ME:"Moi :",LUIDUSERPICKER_ALL:"Tous les utilisateurs"}),e.translations("es",{LUIDUSERPICKER_FORMEREMPLOYEE:"El contrato termina el {{dtContractEnd | luifMoment : 'LL'}}",LUIDUSERPICKER_NORESULTS:"No hay resultados",LUIDUSERPICKER_ERR_GET_USERS:"Error al recuperar los empleados",LUIDUSERPICKER_OVERFLOW:"{{cnt}} resultados mostrados de un total de {{all}}",LUIDUSERPICKER_DEPARTMENT:"Departamento",LUIDUSERPICKER_LEGALENTITY:"Entidad jurídica",LUIDUSERPICKER_EMPLOYEENUMBER:"Número de empleado",LUIDUSERPICKER_MAIL:"correo electrónico",LUIDUSERPICKER_ME:"Yo :",LUIDUSERPICKER_ALL:"Todos los usuarios"})}])}(e.userpicker||(e.userpicker={}))}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(){this.restrict="E",this.templateUrl="lui/templates/user-picker/user-picker.html",this.require=["ngModel",t.IID],this.scope={placeholder:"@",onSelect:"&",onRemove:"&",allowClear:"=?",controlDisabled:"=",showFormerEmployees:"=",homonymsProperties:"=",customFilter:"=",appId:"=",operations:"=",customInfo:"=",customInfoAsync:"=",displayMeFirst:"=",displayAllUsers:"=",customHttpService:"=",bypassOperationsFor:"=",searchByEmployeeNumber:"=",legalEntityIds:"="},this.controller=e.LuidUserPickerController.IID}static factory(){return()=>new t}link(e,t,s,i){e.onOpen=e=>{e?t.addClass("ng-open"):t.removeClass("ng-open")}}}t.IID="luidUserPicker",angular.module("lui.translate").directive(t.IID,t.factory())}(e.userpicker||(e.userpicker={}))}(lui=lui||{}),function(e){!function(e){"use strict";class t{constructor(){this.restrict="E",this.templateUrl="lui/templates/user-picker/user-picker.multiple.html",this.require=["ngModel",t.IID],this.scope={placeholder:"@",onSelect:"&",onRemove:"&",allowClear:"=?",controlDisabled:"=",showFormerEmployees:"=",homonymsProperties:"=",customFilter:"=",appId:"=",operations:"=",customInfo:"=",customInfoAsync:"=",displayMeFirst:"=",customHttpService:"=",bypassOperationsFor:"=",legalEntityIds:"="},this.controller=e.LuidUserPickerController.IID}static factory(){return()=>new t}link(e,t,s,i){e.onOpen=e=>{e?t.addClass("ng-open"):t.removeClass("ng-open")}}}t.IID="luidUserPickerMultiple",angular.module("lui.translate").directive(t.IID,t.factory())}(e.userpicker||(e.userpicker={}))}(lui=lui||{}),function(e){e.userpicker||(e.userpicker={})}(lui=lui||{}),function(e){!function(i){"use strict";class e{constructor(e,t,s){this.meApiUrl="/api/v3/users/me",this.userLookUpApiUrl="/api/v3/users/find",this.userApiUrl="/api/v3/users",this.userLookupFields="fields=id,firstName,lastName,dtContractStart,dtContractEnd,employeeNumber",this.$http=e,this.defaultHttpService=e,this.$q=t,this.stripAccents=s("luifStripAccents")}getMyId(){return this.getMe().then(e=>e.id)}getMe(){return void 0!==this.meCache?this.$q.resolve(this.meCache):this.$http.get(this.meApiUrl+"?"+this.userLookupFields).then(e=>(this.meCache=e.data.data,this.meCache)).catch(e=>{})}getHomonyms(e){return _.chain(e).groupBy(e=>this.concatName(e)).filter(e=>1<e.length).flatten().value()}getUsers(e,t=i.MAGIC_PAGING,s=0){s="paging="+[s,t].join(",");return this.$http.get(this.userLookUpApiUrl+`?${e}&${s}&`+this.userLookupFields).then(e=>e.data.data.items)}getUserById(e){return this.$http.get(`${this.userApiUrl}?id=${e.toString()}&`+this.userLookupFields).then(e=>{e=e.data.data.items;if(e&&0!==e.length)return e[0]})}getUsersByIds(e){let t=new Array;return _.each(e,e=>{t.push(this.getUserById(e))}),this.$q.all(t)}getAdditionalProperties(e,t){var s=_.map(t,e=>e.name).join(",");return this.$http.get(`${this.userApiUrl}?id=${e.id.toString()}&fields=`+s).then(e=>{e=e.data.data.items;let i=new Array;if(e&&e.length){let s=e[0];_.each(t,e=>{var t=this.getProperty(s,e.name);t&&i.push({translationKey:e.translationKey,name:e.name,icon:e.icon,value:t})})}return i})}reduceAdditionalProperties(e){var t=_.chain(e).groupBy(e=>this.concatName(e)).filter(e=>1<e.length).value();return 0===t.length||_.each(t,e=>{let t=new Array;var s=_.chain(e).map(e=>e.additionalProperties).flatten().groupBy(e=>e.name).value();_.each(s,e=>{1===_.uniq(e,e=>e.value).length&&t.push(e[0].name)}),_.each(t,s=>{_.each(e,e=>{var t=_.findIndex(e.additionalProperties,e=>e.name===s);e.additionalProperties.splice(t,1)})})}),e}setCustomHttpService(e){this.$http=e||this.defaultHttpService}getProperty(e,t){t=t.split(".");let s=e;return _.each(t,e=>{s=s&&s[e]?s[e]:void 0}),s}concatName(e){return this.stripAccents(e.firstName.toLowerCase())+this.stripAccents(e.lastName.toLowerCase())}}e.IID="userPickerService",e.$inject=["$http","$q","$filter"],angular.module("lui").service(e.IID,e)}(e.userpicker||(e.userpicker={}))}(lui=lui||{}),function(e){!function(){"use strict";(e.formatter||(e.formatter={})).MomentFormatter=class{constructor(e){this.format=e||"moment"}parseValue(e){switch(this.format){case"moment":return this.parseMoment(e);case"date":return this.parseDate(e);default:return this.parseString(e)}}formatValue(e){if(!e)return e;switch(this.format){case"moment":return this.formatMoment(e);case"date":return this.formatDate(e);default:return this.formatString(e)}}parseMoment(e){return e?moment(e):void 0}parseDate(e){return e?moment(e):void 0}parseString(e){return e&&moment(e,this.format).isValid()?moment(e,this.format):void 0}formatMoment(e){return moment(e)}formatDate(e){return e.toDate()}formatString(e){return e.format(this.format)}}}()}(lui=(lui=lui||{})||{}),function(e){!function(e){"use strict";e.ClickoutsideTrigger=class{constructor(e,t,s){this.elt=e,this.body=angular.element(document.getElementsByTagName("body")[0]),this.$scope=t,this.clickedOutside=s;let i=this;function l(){i.clickedOutside?i.clickedOutside():i.close(),i.$scope.$digest()}function r(e){e.stopPropagation()}this.open=e=>{this.$scope.popover.isOpen=!0,setTimeout(()=>{this.body.on("click",l),this.elt.on("click",r)},100)},this.close=e=>{this.$scope.popover.isOpen=!1,this.body&&(this.body.off("click",l),this.elt.off("click",r))}}toggle(e){this.$scope.popover.isOpen?this.close(e):this.open(e)}}}(e.popover||(e.popover={}))}(lui=lui||{}),function(e){!function(){"use strict";angular.module("lui").directive("luidOnScrollBottom",()=>({restrict:"A",scope:{luidOnScrollBottom:"&"},link:(s,e)=>{e.bind("scroll",e=>{var e=e.target||event.srcElement,t=e.scrollHeight-e.clientHeight;Math.abs(t-e.scrollTop)<2&&s.luidOnScrollBottom&&s.luidOnScrollBottom()})}}))}(e.scroll||(e.scroll={}))}(lui=lui||{}),function(e){!function(){"use strict";class e{constructor(e,t,s,i){this.mainApiUrl="/api/v3/files",this.$http=e,this.$q=t,this._=s,this.moment=i}postFromUrl(e,s){let i=this.$q.defer(),l=new XMLHttpRequest;return l.open("GET",e,!0),l.responseType="arraybuffer",l.onload=e=>{var t=new Blob([l.response],{type:"image/jpeg"});this.postBlob(t,s).then(e=>{i.resolve(e)},e=>{i.reject(e.data.Message)})},l.send(),i.promise}postDataURI(e,t){e=this.dataURItoBlob(e);return this.postBlob(e,t)}postBlob(e,t){let s=this.$q.defer();var i=this.mainApiUrl;let l=new FormData;return l.append(t.substring(0,t.lastIndexOf(".")),e,t),this.$http({method:"POST",url:i,data:l,headers:{"Content-Type":void 0,Accept:void 0},transformRequest:angular.identity}).then(e=>{s.resolve(e.data.data)},e=>{s.reject(e.data.Message)}),s.promise}dataURItoBlob(e){let t=atob(e.split(",")[1]);var e=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(t.length);let i=new Uint8Array(s);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);return new Blob([s],{type:e})}}e.IID="uploaderService",e.$inject=["$http","$q","_","moment"];angular.module("lui").service(e.IID,e)}(e.upload||(e.upload={}))}(lui=(lui=lui||{})||{}),angular.module("lui").run(["$templateCache",function(e){"use strict";e.put("lui/templates/date-picker/datepicker-inline.html",'<div class="calendars"><div class="calendar" mode="{{ mode }}" ng-repeat="calendar in calendars" ng-class="[direction]"><header><button class="previous" ng-click="previous()"></button> <span ng-switch="mode"><span ng-switch-default ng-click="switchToMonthMode()">{{ calendar.date | luifMoment : calendar.currentYear ? "MMMM" : "MMMM - YYYY" }}</span> <span ng-switch-when="1" ng-click="switchToYearMode()">{{ calendar.date | luifMoment : "YYYY" }}</span> <span ng-switch-when="2">{{ calendar.date.year() }} - {{ calendar.date.year() + 11 }}</span> </span><button class="next" ng-click="next()"></button></header><table class="days"><thead><th ng-repeat="dayLabel in dayLabels">{{ ::dayLabel }}</th></thead><tbody><tr ng-repeat="week in calendar.weeks"><td ng-repeat="day in week.days" ng-class="[{empty: day.empty, selected: day.selected}, day.customClass]" ng-disabled="day.disabled" ng-click="selectDay(day)">{{ ::day.dayNum }}</td></tr></tbody></table><div class="months"><ul><li ng-repeat="m in calendar.months" ng-click="selectMonth(m)" ng-disabled="m.disabled" ng-class="[{selected: m.selected}, m.customClass]">{{ m.date | luifMoment : "MMM" }}</li></ul></div><div class="years"><ul><li ng-repeat="y in calendar.years" ng-disabled="y.disabled" ng-click="selectYear(y)" ng-class="[{selected: y.selected}, y.customClass]">{{ y.date | luifMoment : "YYYY" }}</li></ul></div></div></div><footer ng-if="!!shortcuts || !!groupedShortcuts"><ul><li ng-if="!!shortcuts.length"><ul><li class="shortcut" ng-repeat="shortcut in shortcuts"><a class="lui small grey wired button" ng-click="selectShortcut(shortcut)">{{ ::shortcut.label }}</a></li></ul></li><li class="group" ng-if="!!groupedShortcuts.length" ng-repeat="group in groupedShortcuts"><ul><li class="shortcut" ng-repeat="shortcut in group"><a class="lui small grey wired button" ng-click="selectShortcut(shortcut)">{{ ::shortcut.label }}</a></li></ul></li></ul></footer>'),e.put("lui/templates/date-picker/datepicker-popup.html",'<div uib-popover-template="\'lui/templates/date-picker/datepicker-inline.html\'" popover-placement="auto bottom-left" popover-trigger="\'none\'" popover-is-open="popover.isOpen" popover-class="lui luid-datepicker" class="lui datepicker input"><input ng-readonly="disableKeyboardInput" ng-model="displayStr" ng-change="onDisplayStrChanged($event)" ng-focus="openPopover($event)" luid-keydown mappings="closePopoverOnKeyPress" placeholder="{{placeholder}}"> <i class="empty" ng-click="clear($event)"></i></div>'),e.put("lui/templates/date-picker/daterangepicker-popover.html",'<div class="calendars"><div class="calendar" mode="{{ mode }}" ng-repeat="calendar in calendars" ng-class="[direction]"><header><button class="previous" ng-click="previous()"></button> <span ng-switch="mode"><span ng-switch-default ng-click="switchToMonthMode()">{{ calendar.date | luifMoment : calendar.currentYear ? "MMMM" : "MMMM - YYYY" }}</span> <span ng-switch-when="1" ng-click="switchToYearMode()">{{ calendar.date | luifMoment : "YYYY" }}</span> <span ng-switch-when="2">{{ calendar.date.year() }} - {{ calendar.date.year() + 11 }}</span> </span><button class="next" ng-click="next()"></button></header><table class="days"><thead><th ng-repeat="dayLabel in dayLabels">{{ ::dayLabel }}</th></thead><tbody><tr ng-repeat="week in calendar.weeks"><td ng-repeat="day in week.days" ng-class="[{empty: day.empty, selected: day.selected, start: day.start, end: day.end, \'in-between\': day.inBetween}, day.customClass]" ng-disabled="day.disabled" ng-mouseenter="onMouseEnter(day)" ng-mouseleave="onMouseLeave(day)" ng-click="selectDay(day)">{{ ::day.dayNum }}</td></tr></tbody></table><div class="months"><ul><li ng-repeat="m in calendar.months" ng-click="selectMonth(m)" ng-disabled="m.disabled" ng-mouseenter="onMouseEnter(m)" ng-mouseleave="onMouseLeave(m)" ng-class="[{selected: m.selected, start: m.start, end: m.end, \'in-between\': m.inBetween}, m.customClass]">{{ m.date | luifMoment : "MMM" }}</li></ul></div><div class="years"><ul><li ng-repeat="y in calendar.years" ng-disabled="y.disabled" ng-click="selectYear(y)" ng-mouseenter="onMouseEnter(y)" ng-mouseleave="onMouseLeave(y)" ng-class="[{selected: y.selected, start: y.start, end: y.end, \'in-between\': y.inBetween}, y.customClass]">{{ y.date | luifMoment : "YYYY" }}</li></ul></div></div></div><footer ng-if="!!shortcuts || !!groupedShortcuts"><ul><li ng-if="!!shortcuts.length"><ul><li class="shortcut" ng-repeat="shortcut in shortcuts"><a class="lui small grey wired button" ng-click="selectShortcut(shortcut)">{{ ::shortcut.label }}</a></li></ul></li><li class="group" ng-if="!!groupedShortcuts.length" ng-repeat="group in groupedShortcuts"><ul><li class="shortcut" ng-repeat="shortcut in group"><a class="lui small grey wired button" ng-click="selectShortcut(shortcut)">{{ ::shortcut.label }}</a></li></ul></li></ul></footer>'),e.put("lui/templates/date-picker/daterangepicker.html",'<div class="lui daterange fitting input" uib-popover-template="\'lui/templates/date-picker/daterangepicker-popover.html\'" popover-placement="auto bottom-left" popover-trigger="\'none\'" popover-is-open="popover.isOpen" popover-class="lui luid-daterangepicker" ng-click="togglePopover($event)"><div class="inputs" ng-if="popover.isOpen"><input auto-focus ng-readonly="disableKeyboardInput" ng-class="{ \'clickable\': disableKeyboardInput, \'focus\': !!editingStart}" ng-click="editStart($event)" ng-model="internal.startDisplayStr" ng-change="onStartDisplayStrChanged($event)" placeholder="{{fromLabel}}" luid-keydown mappings="focusEndInputOnTab"> <i class="lui east arrow icon"></i> <input ng-readonly="disableKeyboardInput" ng-class="{ \'clickable\': disableKeyboardInput, \'focus\': !editingStart}" ng-model="internal.endDisplayStr" ng-click="editEnd($event)" ng-change="onEndDisplayStrChanged($event)" placeholder="{{toLabel}}" luid-keydown mappings="closePopoverOnTab"></div><i class="empty" ng-click="clear($event)"></i><input ng-readonly="disableKeyboardInput" ng-model="displayStr" placeholder="{{placeholder}}"></div>'),e.put("lui/templates/department-picker/department-picker.html",'<ui-select ng-class="{\'is-searching\': !!$select.search}" ng-model="internal.selectedDepartment" ng-disabled="controlDisabled" search-enabled="true" on-select="selectDepartment()" uis-open-close="onDropdownToggle(isOpen)"><ui-select-match placeholder="{{ $select.selected.name }}" allow-clear="true" title="{{ $select.selected.name }}">{{ $select.selected.name }}</ui-select-match><ui-select-choices repeat="department in departmentsToDisplay track by $index" luid-on-scroll-bottom="loadMore($select.search)" refresh="search($select.search)" refresh-delay="0"><div ng-class="{\'has-child\': !!department.hasChild}"><em ng-if="!$select.search" class="departmentpicker-tree-level" ng-repeat="level in getLevel(department) track by $index"></em> <span class="departmentpicker-label" ng-bind-html="department.name | highlight: $select.search"></span></div><small ng-if="!!$select.search"><i ng-bind-html="department.ancestorsLabel | highlight: $select.search"></i></small></ui-select-choices></ui-select>'),e.put("lui/templates/formly/fields/api-select-multiple.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-api-select-multiple api="options.templateOptions.api" filter="options.templateOptions.filter" placeholder="{{::options.templateOptions.placeholder}}" name="{{::id}}" ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}"></luid-api-select-multiple><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/api-select.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-api-select api="options.templateOptions.api" allow-clear="options.templateOptions.allowClear" filter="options.templateOptions.filter" placeholder="{{::options.templateOptions.placeholder}}" name="{{::id}}" ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}"></luid-api-select><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/checkbox.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui checkbox {{::options.templateOptions.style}} input"><input type="checkbox" name="{{::id}}" ng-model="model[options.key]" ng-disabled="options.templateOptions.disabled"> <label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small></div>'),e.put("lui/templates/formly/fields/date.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-date-picker-popup class="{{::options.templateOptions.style}}" ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" name="{{::id}}" ng-disabled="options.templateOptions.disabled"></luid-date-picker-popup><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/daterange.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-daterange-picker ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" name="{{::id}}" ng-disabled="options.templateOptions.disabled"></luid-daterange-picker><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/department.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-department-picker ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" name="{{::id}}"></luid-department-picker><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/email.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><input placeholder="{{::options.templateOptions.placeholder }}" type="email" name="{{::id}}" ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled"> <label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.email">{{::options.templateOptions.emailError}}</small></div>'),e.put("lui/templates/formly/fields/iban.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-iban ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" name="{{::id}}" ng-disabled="options.templateOptions.disabled"></luid-iban><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && (form.{{::id}}.$error.iban || form.{{::id}}.$error.maxlength)">{{::options.templateOptions.ibanError}}</small></div>'),e.put("lui/templates/formly/fields/number.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><input placeholder="{{::options.templateOptions.placeholder }}" type="number" name="{{::id}}" ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled"> <label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/picture.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-image-picker class="{{::options.templateOptions.size}} {{::options.templateOptions.style}}" ng-model="model[options.key]" name="{{::id}}" ng-required="{{options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled"></luid-image-picker><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/portrait.html",'<div class="lui {{::options.templateOptions.display}} portrait field"><div class="lui {{::options.templateOptions.style}} input"><luid-image-picker class="{{::options.templateOptions.size}} {{::options.templateOptions.style}}" ng-model="model[options.key]" name="{{::id}}" ng-required="{{options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" delete-enabled="options.templateOptions.deleteEnabled" cropping-ratio="options.templateOptions.ratio"></luid-image-picker><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/radio.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><div class="lui radio input" ng-repeat="choice in options.templateOptions.choices"><input id="{{::id}}_{{$index}}" type="radio" name="{{::id}}" ng-model="model[options.key]" ng-required="{{options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" ng-value="choice"> <label for="{{::id}}_{{$index}}">{{ choice.label }}</label></div><label>{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper}}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/select.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><ui-select ng-model="model[options.key]" ng-required="{{options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" name="{{::id}}" focus-on="{{::id}}"><ui-select-match placeholder="{{::options.templateOptions.placeholder}}" allow-clear="true" title="{{$select.selected.label}}">{{$select.selected.label}}</ui-select-match><ui-select-choices repeat="choice in options.templateOptions.choices | filter : $select.search"><div ng-bind-html="choice.label | highlight: $select.search"></div></ui-select-choices></ui-select><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/text.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><input placeholder="{{::options.templateOptions.placeholder }}" name="{{::id}}" ng-model="model[options.key]" ng-required="{{options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled"> <label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/textarea.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><textarea placeholder="{{::options.templateOptions.placeholder }}" name="{{::id}}" ng-model="model[options.key]" ng-required="{{options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" rows="{{::options.templateOptions.rows }}"></textarea> <label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/user-multiple.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-user-picker-multiple ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" name="{{::id}}"></luid-user-picker-multiple><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/fields/user.html",'<div class="lui {{::options.templateOptions.display}} field"><div class="lui {{::options.templateOptions.style}} input"><luid-user-picker ng-model="model[options.key]" ng-required="{{::options.templateOptions.required}}" ng-disabled="options.templateOptions.disabled" name="{{::id}}" allow-clear="true"></luid-user-picker><label for="{{::id}}">{{ options.templateOptions.label }}</label></div><small class="message helper">{{ options.templateOptions.helper }}</small> <small class="message error lui animated up fade in" ng-show="form.{{::id}}.$dirty && form.{{::id}}.$error.required">{{::options.templateOptions.requiredError}}</small></div>'),e.put("lui/templates/formly/inputs/api-select-multiple.html",'<ui-select multiple><ui-select-match placeholder="{{::placeholder}}" title="{{$item.name}}">{{$item.name}}</ui-select-match><ui-select-choices repeat="choice in choices track by choice.id" refresh="refresh($select.search)" refresh-delay="0" luid-on-scroll-bottom="loadMore($select.search)"><div ng-bind-html="choice.name | highlight: $select.search"></div></ui-select-choices></ui-select>'),e.put("lui/templates/formly/inputs/api-select.html",'<ui-select uis-open-close="onDropdownToggle(isOpen)"><ui-select-match placeholder="{{::placeholder}}" allow-clear="{{allowClear}}" title="{{$select.selected.name}}">{{$select.selected.name}}</ui-select-match><ui-select-choices repeat="choice in choices track by choice.id" refresh="refresh($select.search)" refresh-delay="0" luid-on-scroll-bottom="loadMore($select.search)"><div ng-bind-html="choice.name | highlight: $select.search" ng-hide="$last &&!!choice.loading"></div><div ng-show="$last &&!!choice.loading" class="lui loader"></div></ui-select-choices></ui-select>'),e.put("lui/templates/iban/iban.view.html",'<input id="countryCode" class="upper-case" size="2" maxlength="2" ng-model="countryCode" ng-model-options="{ allowInvalid: true }" ng-change="updateValue()" ng-paste="pasteIban($event)" ng-focus="selectInput($event)" luid-select-next ng-blur="setTouched()"> <input id="controlKey" class="upper-case" size="2" maxlength="2" ng-model="controlKey" ng-model-options="{ allowInvalid: true }" ng-change="updateValue()" luid-select-next ng-blur="setTouched()" luid-keydown mappings="controlKeyMappings"> <input id="bban" class="upper-case" size="22" maxlength="30" ng-model="bban" ng-model-options="{ allowInvalid: true }" ng-change="updateValue()" ng-blur="setTouched()" luid-keydown mappings="bbanMappings">'),e.put("lui/templates/image-picker/image-cropper.modal.html",'<div class="luid-cropper"><ui-cropper image="image" result-image="cropped" area-type="rectangle" result-image-size="\'max\'" aspect-ratio="croppingRatio"></ui-cropper></div><footer class="modal-footer lui right aligned"><div class="lui button" ng-click="crop()">{{ \'LUIIMGCROPPER_CROP\' | translate }}</div><div class="lui button" ng-click="donotcrop()">{{ \'LUIIMGCROPPER_DO_NOT_CROP\' | translate }}</div><div class="lui flat button" ng-click="cancel()">{{ cancelLabel }}</div></footer>'),e.put("lui/templates/image-picker/image-picker-popovermenu.html",'<ul class="image-picker-menu"><li class="image-picker-menu-item" ng-click="uploadNewImage($event)" translate="LUIIMGPICKER_MODIFY_IMAGE"></li><li class="image-picker-menu-item" ng-click="onDelete()" translate="LUIIMGPICKER_DELETE_IMAGE"></li></ul>'),e.put("lui/templates/image-picker/image-picker.html",'<div class="lui image-picker" ng-class="{ uploading: uploading, \'is-disabled\': isDisabled }" uib-popover-template="\'lui/templates/image-picker/image-picker-popovermenu.html\'" popover-trigger="\'none\'" popover-is-open="popover.isOpen" popover-class="lui luid-image-picker-popup" ng-click="togglePopover($event)"><div class="luid-image-picker-picture" ng-style="pictureStyle"><input accept="image/*" type="file" ng-disabled="!!isDisabled" ng-model="file" class="fileInput" file-model="image" luid-image-cropper on-cropped="onCropped" on-cancelled="onCancelled" cropping-disabled="croppingDisabled" cropping-ratio="croppingRatio" onclick="event.stopPropagation()"><div class="upload-overlay"><div class="lui inverted loader"></div></div><div class="input-overlay" ng-class="{\'hide-editable\': hideEditHint}"><div class="overlay-content"><i class="lui icon edit"></i> <span class="lui capitalized sentence" translate="LUIIMGPICKER_UPLOAD_IMAGE"></span></div></div></div>'),e.put("lui/templates/notify-service/alert.html",'<section>{{message}}</section><footer class="lui right aligned"><button class="lui button" ng-click="ok()">{{okLabel}}</button></footer>'),e.put("lui/templates/notify-service/confirm.html",'<section>{{message}}</section><footer class="lui right aligned"><button class="lui button" ng-click="ok()">{{okLabel}}</button> <button class="lui flat button" ng-click="cancel()">{{cancelLabel}}</button></footer>'),e.put("lui/templates/notify-service/error.html",'<div class="lui callout filled luis-notify red typeset" ng-style="{\'margin-left\': $centerMargin}"><div class="lui small red button icon cross close" ng-click="$close()"></div><h5 ng-show="!$message">Error</h5><h5 ng-hide="!$message">{{ $message }}</h5></div>'),e.put("lui/templates/notify-service/loading.html",'<div class="lui up callout luis-notify typeset" ng-class="[calloutClass]" ng-style="{\'margin-left\': $centerMargin}"><div class="lui small filling button icon cross close" ng-click="$close()" ng-hide="loading"></div><div class="lui small filling button icon cross close" ng-click="cancel()" ng-show="loading && canCancel"></div><h5 ng-show="!message"><span class="lui loader" ng-show="loading"></span>&nbsp;&nbsp;Loading</h5><h5 ng-hide="!message"><span class="lui loader" ng-show="loading"></span>&nbsp;&nbsp;{{ message }}</h5></div>'),e.put("lui/templates/notify-service/success.html",'<div class="lui green up callout luis-notify typeset" ng-style="{\'margin-left\': $centerMargin}"><div class="lui small filling button icon cross close" ng-click="$close()"></div><h5 ng-show="!$message">Success</h5><h5 ng-hide="!$message">{{ $message }}</h5></div>'),e.put("lui/templates/notify-service/warning.html",'<div class="lui orange up callout luis-notify typeset" ng-style="{\'margin-left\': $centerMargin}"><div class="lui small filling button icon cross close" ng-click="$close()"></div><h5 ng-show="!$message">Warning</h5><h5 ng-hide="!$message">{{ $message }}</h5></div>'),e.put("lui/templates/table-grid/table-grid.html",'<div class="lui tablegrid"><div class="scrollable columns"><div class="virtualscroll" ng-include="\'lui/templates/table-grid/table-grid.table.html\'"></div></div><div class="locked columns" ng-if="existFixedRow || isSelectable"><div class="holder"><div class="virtualscroll" ng-include="\'lui/templates/table-grid/table-grid.table.html\'"></div></div></div></div>'),e.put("lui/templates/table-grid/table-grid.table.html",'<table><thead><tr role="row" ng-repeat="row in ::headerRows track by $index" ng-if="$index !== 0"><th ng-if="isSelectable" style="width: 3.5em" class="locked" role="columnheader" colspan="1" rowspan="1"></th><th role="columnheader" class="sortable" ng-repeat="header in ::row track by $index" ng-click="updateOrderedRows(header)" ng-class="{\'locked\': header.fixed, \'desc\': (selected.orderBy === header && selected.reverse === false), \'asc\': (selected.orderBy === header && selected.reverse === true)}" ng-style="{\'max-width\': header.width + \'em\', \'min-width\': header.width + \'em\', \'text-align\': header.textAlign}" rowspan="{{ header.rowspan }}" colspan="{{ header.colspan }}">{{ header.label }}</th></tr><tr role="row"><th ng-if="isSelectable" style="width: 3.5em" class="locked" role="columnheader" colspan="1" rowspan="1"><div class="lui solo checkbox input"><input ng-class="masterCheckBoxCssClass" type="checkbox" ng-model="allChecked.value" ng-change="onMasterCheckBoxChange()" ng-value="true"> <label>&nbsp;</label></div></th><th role="columnheader" ng-repeat="header in ::colDefinitions track by $index" ng-style="{\'max-width\': header.width + \'em\', \'min-width\': header.width + \'em\'}" ng-if="::header.filterType != FilterTypeEnum.NONE" colspan="1" rowspan="1" class="filtering"><div class="lui fitting searchable input" ng-if="::header.filterType === FilterTypeEnum.TEXT"><input ng-change="updateFilteredRows()" ng-model="filters[$index].currentValues[0]" ng-model-options="{ updateOn: \'default blur\', debounce: { \'default\': 500, \'blur\': 0 } }"></div><div class="lui fitting input" ng-if="header.filterType === FilterTypeEnum.MULTISELECT && filters[$index].selectValues.length > 1"><ui-select multiple ng-model="filters[$index].currentValues" reset-search-input="true" on-remove="updateFilteredRows()" on-select="updateFilteredRows()"><ui-select-match placeholder="{{ \'SELECT_ITEMS\' | translate }}">{{ $item }}</ui-select-match><ui-select-choices repeat="value in filters[$index].selectValues | filter: $select.search"><span ng-bind-html="value"></span></ui-select-choices></ui-select></div><div class="lui fitting input" ng-if="header.filterType === FilterTypeEnum.SELECT && filters[$index].selectValues.length > 1"><ui-select ng-model="filters[$index].currentValues[0]" reset-search-input="true" on-select="updateFilteredRows()" allow-clear><ui-select-match allow-clear="true" placeholder="{{ \'SELECT_ITEM\' | translate }}" title="{{ $select.selected }}">{{ $select.selected }}</ui-select-match><ui-select-choices repeat="value in filters[$index].selectValues | filter: $select.search"><span ng-bind-html="value"></span></ui-select-choices></ui-select></div></th></tr></thead><tbody><tr role="row" ng-repeat="row in visibleRows" ng-style="row.styles" ng-click="internalRowClick($event, row);"><td ng-if="isSelectable" style="width: 3.5em" class="locked" colspan="1" rowspan="1"><div class="lui solo checkbox input"><input type="checkbox" ng-change="onCheckBoxChange()" ng-model="row._luiTableGridRow.isChecked"> <label>&nbsp;</label></div></td><td role="cell" ng-repeat="cell in ::colDefinitions track by $index" ng-style="{\'max-width\': cell.width + \'em\', \'min-width\': cell.width + \'em\', \'white-space\': cell.preserveLineBreaks ? \'pre-line\' : \'normal\'}" ng-bind-html="cell.getValue(row)" ng-class="{\'locked\': cell.fixed, \'lui left aligned\': cell.textAlign == \'left\', \'lui right aligned\': cell.textAlign == \'right\', \'lui center aligned\': cell.textAlign == \'center\'}"></td></tr></tbody></table>'),e.put("lui/templates/translations-list/translations-list.html",'<div><nav class="lui dividing justified primary menu"><a class="lui item" ng-repeat="culture in cultures" ng-class="{ \'active\': culture === selectedCulture }" ng-click="selectCulture(culture)" ng-bind-html="culture | uppercase"></a></nav><content><ul class="lui unstyled field container"><li class="lui input animated left fade in" ng-repeat="value in values[selectedCulture].values track by $index"><input ng-model="values[selectedCulture].values[$index].value" ng-disabled="isDisabled" ng-paste="onPaste($event, $index)" placeholder="{{ getPlaceholder(selectedCulture, $index) }}" ng-change="onInputValueChanged()" luid-keydown mappings="addValueOnEnter" id="{{ getUniqueId($parent.selectedCulture, $index) }}"> <button class="lui flat button icon cross close animated right fade in" ng-click="deleteValue($index)" ng-if="!isDisabled" tabindex="-1"></button></li></ul><footer ng-if="!isDisabled"><button ng-click="addValueAndFocus()" ng-hide="isAddValueDisabled()" class="lui button filled animated up fade in" translate="LUID_TRANSLATIONSLIST_ADD_VALUE"></button></footer></content></div>'),e.put("lui/templates/user-picker/user-picker.html",'<ui-select ng-disabled="controlDisabled" search-enabled="true" on-select="onSelect()" on-remove="onRemove()" uis-open-close="onOpen(isOpen)" open-on="toggleFormerEmployees"><ui-select-match placeholder="{{placeholder}}" allow-clear="{{!!allowClear}}" title="{{$select.selected.lastName + \' \' + $select.selected.firstName}}"><span ng-if="$select.selected.id === -1" translate>LUIDUSERPICKER_ALL</span> <span ng-if="$select.selected.id !== -1" ng-bind-html="$select.selected.lastName + \' \' + $select.selected.firstName"></span></ui-select-match><ui-select-choices repeat="user in users track by $index" refresh="find($select.search)" refresh-delay="0" luid-on-scroll-bottom="loadMore()"><div ng-if="user.id === myId" class="selected-first" ng-class="{\'dividing\': $index === 0}" ng-bind-html="user.lastName + \' \' + user.firstName | luifHighlight : $select.search : user.info : \'LUIDUSERPICKER_ME\'"></div><div ng-if="user.id === -1" translate>LUIDUSERPICKER_ALL</div><div ng-if="user.id !== myId" ng-bind-html="user.lastName + \' \' + user.firstName | luifHighlight : $select.search : user.info"></div><div ng-if="user.hasLeft"><small translate translate-values="{dtContractEnd:user.dtContractEnd}">LUIDUSERPICKER_FORMEREMPLOYEE</small></div><div ng-if="user.hasHomonyms" ng-repeat="property in user.additionalProperties"><small><i class="lui icon {{property.icon}}"></i> <b data-ng-bind-html="property.translationKey | translate"></b> <span data-ng-bind-html="property.value"></span></small></div></ui-select-choices></ui-select>'),e.put("lui/templates/user-picker/user-picker.multiple.html",'<ui-select multiple ng-disabled="controlDisabled" search-enabled="true" on-select="onSelect()" on-remove="onRemove()" close-on-select="false" reset-search-input="true" uis-open-close="onOpen(isOpen)" open-on="toggleFormerEmployees"><ui-select-match placeholder="{{placeholder}}" allow-clear="{{!!allowClear}}">{{$item.lastName}} {{$item.firstName}}</ui-select-match><ui-select-choices repeat="user in users track by $index" refresh="find($select.search)" refresh-delay="0" luid-on-scroll-bottom="loadMore()"><div ng-if="user.id === myId" class="selected-first" ng-class="{\'dividing\': $index === 0}" ng-bind-html="user.lastName + \' \' + user.firstName | luifHighlight : $select.search : user.info : \'LUIDUSERPICKER_ME\'"></div><div ng-if="user.id === -1" translate>LUIDUSERPICKER_ALL</div><div ng-if="user.id !== myId" ng-bind-html="user.lastName + \' \' + user.firstName | luifHighlight : $select.search : user.info"></div><div ng-if="user.hasLeft"><small translate translate-values="{dtContractEnd:user.dtContractEnd}">LUIDUSERPICKER_FORMEREMPLOYEE</small></div><div ng-if="user.hasHomonyms" ng-repeat="property in user.additionalProperties"><small><i class="lui icon {{property.icon}}"></i> <b data-ng-bind-html="property.translationKey | translate"></b> <span data-ng-bind-html="property.value"></span></small></div></ui-select-choices></ui-select>')}]),function(){"use strict";angular.module("lui").directive("luidDayBlock",function(){return{template:'<div><div ng-style="controller.weekdayStyleOverride()" ng-if = "controller.showDay" class="weekday">{{controller.date | luifMoment: \'dddd\'}}</div><div ng-style="controller.dayStyleOverride()" class="day">{{controller.date | luifMoment:\'DD\'}}</div><div ng-style="controller.monthStyleOverride()" class="month">{{controller.date | luifMoment: \'MMM\'}}</div><div ng-style="controller.yearStyleOverride()" class="year">{{controller.date | luifMoment: \'YYYY\'}}</div></div>',scope:{date:"=",showDay:"=",primaryColor:"=",secondaryColor:"="},restrict:"E",bindToController:!0,controllerAs:"controller",controller:"luidDayBlockController"}}).controller("luidDayBlockController",function(){var e=this;e.weekdayStyleOverride=function(){return{color:e.primaryColor}},e.dayStyleOverride=function(){return{"background-color":e.primaryColor,"border-color":e.primaryColor,color:e.secondaryColor}},e.monthStyleOverride=function(){return{"background-color":e.secondaryColor,"border-color":e.primaryColor,color:e.primaryColor}},e.yearStyleOverride=function(){return{"background-color":e.secondaryColor,"border-color":e.primaryColor,color:e.primaryColor}}})}(),function(){"use strict";angular.module("lui").directive("luidKeydown",function(){return{restrict:"A",scope:{mappings:"="},link:function(t,e,s){e.on("keydown",function(e){t.mappings&&t.mappings[e.which]&&t.mappings[e.which](e)})}}}),angular.module("lui").directive("luidSelectOnClick",function(){return{restrict:"A",link:function(e,t,s){t.on("click",function(){this.select()}),t.on("focus",function(){this.select()})}}}),angular.module("lui").directive("luidFocusOn",function(){return function(t,s,e){t.$on(e.luidFocusOn,function(e){setTimeout(function(){s[0].focus(),t.$apply()},1)})}})}(),function(){"use strict";angular.module("lui.translate").directive("luidTranslations",["$translate","_","$filter","$timeout",function(f,v,e,t){return{require:["luidTranslations","^ngModel"],controller:"luidTranslationsController",scope:{mode:"@",size:"@",isDisabled:"=ngDisabled"},templateUrl:"lui/directives/luidTranslations.html",restrict:"EA",link:function(l,e,r,t){var a=t[1],s=t[0],n={en:1033,de:1031,es:1034,fr:1036,it:1040,nl:2067,pt:2070},o=v.keys(n),i=(l.cultures=o,l.currentCulture=f.preferredLanguage()||"en",r.mode||"dictionary"),u=("dictionary"===i&&void 0!==a.$viewValue&&v.each(o,function(e){l.$watch(function(){return a.$viewValue&&a.$viewValue[e]},function(){a.$render()})}),a.$render=function(){l.internal=u(a.$viewValue),s.updateTooltip()},s.updateViewValue=function(){switch(i){case"dictionary":return h(l.internal);case"|":case"pipe":return g(l.internal);case"lucca":return c(l.internal)}},s.updateTooltip=function(){var e="";if(l.internal){for(var t=0;t<l.cultures.length;t++)l.internal[l.cultures[t]]&&(e+="["+l.cultures[t].toUpperCase()+"] : "+l.internal[l.cultures[t]]+"\n");l.tooltipText=e}else l.tooltipText=void 0},function(e){if(void 0!==e)switch(i){case"dictionary":return p(e);case"|":case"pipe":return m(e);case"lucca":return d(e);default:return}}),d=function(i){return v.reduce(o,function(e,t){var s=v.findWhere(i,{cultureCode:n[t]});return e[t]=s?s.value:void 0,e[t+"_id"]=s?s.id:void 0,e},{})},c=function(t){var s=!0,i=[];v.each(o,function(e){t[e]&&""!==t[e]&&(i.push({id:t[e+"_id"],cultureCode:n[e],value:t[e]}),s=!1)}),a.$setViewValue(s?void 0:i),l.$parent.$eval(r.ngChange)},p=function(s){return v.reduce(o,function(e,t){return e[t]=s[t],e},{})},h=function(t){var s=!0,i={};v.each(o,function(e){i[e]=t[e],s&=void 0===t[e]||""===t[e]}),a.$setViewValue(s?void 0:i),l.$parent.$eval(r.ngChange)},m=function(e){var e=e.split("|"),s={};return v.each(e,function(e){var t=e.substring(0,2),e=e.substring(3);s[t]=e}),v.pick(s,o)},g=function(t){var e;v.find(o,function(e){return void 0!==t[e]&&""!==t[e]})?(e=v.map(o,function(e){return t[e]?e+":"+t[e]:e+":"}).join("|"),a.$setViewValue(e)):a.$setViewValue(void 0)}}}}]).controller("luidTranslationsController",["$scope","$translate","$timeout",function(e,t,s){var i=this;e.update=function(){i.updateViewValue(),i.updateTooltip()},e.focusInput=function(){e.focused=!0},e.blurInput=function(){e.focused=!1},e.blurOnEnter=function(e){e.target.blur(),e.preventDefault()}}]),angular.module("lui").run(["$templateCache",function(e){e.put("lui/directives/luidTranslations.html",'<div class="lui dropdown {{size}} field" ng-class="{open:focused}" tooltip-class="lui" tooltip-placement="top"  uib-tooltip="{{tooltipText}}">\t<div class="lui input">\t\t<input type="text" ng-disabled="isDisabled" ng-model="internal[currentCulture]" ng-focus="focusInput()" ng-blur="blurInput()" ng-keypress="$event.keyCode === 13 && blurOnEnter($event)" ng-change="update()">\t\t<span class="unit">{{currentCulture}}</span>\t</div>\t<div class="dropdown-menu">\t\t<div class="lui {{size}} field" ng-repeat="culture in cultures" ng-if="culture !== currentCulture">\t\t\t<div class="lui input">\t\t\t\t<input type="text" ng-disabled="isDisabled" ng-model="internal[culture]" ng-focus="focusInput()" ng-blur="blurInput()" ng-keypress="$event.keyCode === 13 && blurOnEnter($event)" ng-change="update()">\t\t\t\t<span class="unit addon">{{culture}}</span>\t\t\t</div>\t\t</div>\t</div></div>')}])}(),function(){"use strict";angular.module("lui").directive("luidMoment",["moment",function(n){return{require:["luidMoment","^ngModel"],controller:"luidMomentController",scope:{min:"=",max:"=",step:"=",referenceDate:"=",isDisabled:"=",showButtons:"=",enforceValid:"=",format:"=",minOffset:"=",maxOffset:"="},templateUrl:"lui/directives/luidMoment.html",restrict:"EA",link:function(s,e,t,i){var l,r=i[1],a=i[0],i=(t.format?(l=s.$eval(t.format),r.getValue=function(){var e=r.$viewValue;if(e){e=n(e,l);if(e.isValid())return e}},r.$render=function(){var e=r.getValue();s.hours=e?e.format("HH"):void 0,s.mins=e?e.format("mm"):void 0,r.$validate()},r.setValue=function(e){r.$setViewValue(e?e.format(l):void 0)},r.$validators.min=function(e,t){return!t||a.checkMin(n(e,l))},r.$validators.max=function(e,t){return!t||a.checkMax(n(e,l))}):(r.getValue=function(){var e=r.$viewValue;if(e){var t=n(e);if(e.isValid())return t}},r.$render=function(){var e=r.getValue(),t=!!e&&e.isValid();s.hours=t?e.format("HH"):void 0,s.mins=t?e.format("mm"):void 0,r.$validate()},r.setValue=function(e){r.$setViewValue(e)},r.$validators.min=function(e,t){return!t||a.checkMin(e)},r.$validators.max=function(e,t){return!t||a.checkMax(e)}),(s.ngModelCtrl=r).$validators.hours=function(e,t){return void 0!==s.hours&&""!==s.hours&&!isNaN(parseInt(s.hours))},r.$validators.minutes=function(e,t){return void 0!==s.mins&&""!==s.mins&&parseInt(s.mins)<60},e.querySelectorAll(".input"));a.setupEvents(e,angular.element(i[0]),angular.element(i[1])),s.$watch("min",function(){r.$validate()}),s.$watch("max",function(){r.$validate()})}}}]).controller("luidMomentController",["$scope","$timeout","moment","$element",function(c,t,a,l){function p(e){var t,s,i;c.isDisabled||r(((s=a(m()))&&s.isValid()||(s=n().startOf("day")),i=b,t=Math.abs(e),-1!==i.indexOf(t)&&s.minutes()%e!=0&&(e=e<0?-s.minutes()%e:-s.minutes()%e+e),(i=s.add(e,"m")).seconds(0),i),!0)}function r(e,t){s(e,t),c.ngModelCtrl.$render()}function s(e,t){var s=u(),i=d();t&&(t=function(e,t,s){switch(!0){case!e:return e;case t&&0<t.diff(e):return t;case s&&s.diff(e)<0:return s;default:return e}}(e,s,i)).format("HH:mm")!==e.format("HH:mm")&&(e=t,l.addClass("autocorrect"),setTimeout(function(){l.removeClass("autocorrect")},200)),c.maxed=e&&i&&i.diff(e)<=0,c.mined=e&&s&&0<=s.diff(e),c.ngModelCtrl.setValue(e)}function e(){var e,t,s,i,l,r;if(void 0!==c.hours&&""!==c.hours&&void 0!==c.mins&&""!==c.mins)return t=parseInt(c.hours),s=parseInt(c.mins),60<s&&(s=59,c.mins="59"),t=n().hours(t).minutes(s).seconds(0),t=a(t),s=a(t),i=a(t),l=u(),r=d(),l&&t.isBefore(l)&&(e=Math.ceil(l.diff(t,"day",!0)),s.add(e,"day")),r&&t.isAfter(r)&&(e=Math.floor(r.diff(t,"day",!0)),i.add(e,"days")),r&&(s.isBefore(r)||s.isSame(r))?s:l&&(i.isAfter(l)||i.isSame(l))?i:t}function i(){function e(e){e&&t.cancel(e)}e(y),e(E)}function h(){return isNaN(parseInt(c.step))?5:parseInt(c.step)}function n(){function e(e){return e&&a(e).isValid()?a(e):void 0}return e(c.referenceDate)||e(c.min)||e(c.max)||a()}function o(t,e,s){var i;if(t)return i=function(){switch(!0){case!!t.isValid&&!!t.isValid():return a(t);case a(t,"YYYY-MM-DD HH:mm").isValid():return a(t,"YYYY-MM-DD HH:mm");case a(t,"HH:mm").isValid():var e=n(),e=a(t,"HH:mm").year(e.year()).month(e.month()).date(e.date());return s&&e.hours()+e.minutes()===0&&e.add(1,"d"),e}}(),i.add(a.duration(e)),i}function u(){return o(c.min,c.minOffset,!1)}function d(){return o(c.max,c.maxOffset,!0)}function m(){return c.format?a(c.ngModelCtrl.$viewValue,c.format):c.ngModelCtrl.$viewValue}function g(e,t){i(),p(t),c.$broadcast(e)}function f(e){i(),c.minsFocused=!!e,c.hoursFocused=!e}function v(){s(c.ngModelCtrl.$modelValue),t(function(){r(m(),c.enforceValid)},200)}var y,E,b=[5,10,15,20,30];function C(e){return void 0===e||""===e}c.pattern=/^([0-9]{0,2})?$/,c.incrHours=function(){g("focusHours",60)},c.decrHours=function(){g("focusHours",-60)},c.incrMins=function(){g("focusMinutes",h())},c.decrMins=function(){g("focusMinutes",-h())},c.changeHours=function(){if(C(c.hours))return s(void 0);C(c.mins)&&(c.mins="00"),2==c.hours.length?(23<parseInt(c.hours)&&(c.hours="23"),c.$broadcast("focusMinutes")):1==c.hours.length&&2<parseInt(c.hours)&&(c.hours=0+c.hours,c.$broadcast("focusMinutes")),s(e())},c.changeMins=function(){!c.mins||c.mins.length<2?c.ngModelCtrl.$setValidity("minutes",!1):s(e())},c.formatInputValue=function(){c.ngModelCtrl.$render()},c.getDayGap=function(){var e=n().startOf("day");return a.duration(a(m()).startOf("d").diff(e)).asDays()},c.blurHours=function(){v(c.hoursFocused)},c.blurMins=function(){c.mins?c.mins.length<2&&(c.mins="0"+c.mins):""===c.hours||void 0===c.hours?c.mins=void 0:c.mins="00",v(c.minsFocused)},c.focusHours=function(){f(!1)},c.focusMins=function(){f(!0)},this.checkMin=function(e){var t=u();return!t||t.diff(e)<=0},this.checkMax=function(e){var t=d();return!t||0<=t.diff(e)},this.setupEvents=function(e,t,s){var i,l,r,a,n=angular.element(t.find("input")[0]),o=angular.element(s.find("input")[0]);function u(e,t){switch(e.which){case 38:e.preventDefault(),p(t),c.$apply();break;case 40:e.preventDefault(),p(-t),c.$apply();break;case 13:e.preventDefault(),c.formatInputValue(),c.$apply()}}function d(e,t){var s,i;!c.isDisabled&&r&&(c.$apply(p((i=(s=(s=e).originalEvent||s).wheelDelta||-s.deltaY,s.detail||0<i?t:-t))),e.preventDefault())}n=n,o=o,i=h(),n.bind("keydown",function(e){u(e,60)}),o.bind("keydown",function(e){u(e,i)}),n=t,o=s,r=!1,(t=e).bind("mouseenter",function(e){l=setTimeout(function(){r=!0},200)}),t.bind("mouseleave",function(e){l&&clearTimeout(l),r=!1}),a=h(),n.bind("mousewheel wheel",function(e){d(e,60)}),o.bind("mousewheel wheel",function(e){d(e,a)})}}]),angular.module("lui").run(["$templateCache",function(e){e.put("lui/directives/luidMoment.html","<div class='lui hours moment input' ng-class='{disabled: isDisabled}'>\t<input type='text' ng-model='hours' ng-change='changeHours()' luid-select-on-click ng-pattern='pattern' luid-focus-on='focusHours' ng-focus='focusHours()' ng-blur='blurHours()' ng-disabled='isDisabled' maxLength='2' autocorrect='off' spellcheck='false' ng-model-options=\"{updateOn: 'blur'}\">\t<i ng-click='incrHours()' ng-show='showButtons && hoursFocused' class='lui mp-button top left north arrow icon' ng-class='{disabled: maxed}'></i>\t<i ng-click='decrHours()' ng-show='showButtons && hoursFocused' class='lui mp-button bottom left south arrow icon' ng-class='{disabled: mined}'></i></div><span class='separator'>:</span><div class='lui minutes moment input' ng-class='{disabled: isDisabled}'>\t<input type='text' ng-model='mins' ng-change='changeMins()' luid-select-on-click ng-pattern='pattern' luid-focus-on='focusMinutes' ng-focus='focusMins()' ng-blur='blurMins()' ng-disabled='isDisabled' maxLength='2' autocorrect='off' spellcheck='false' ng-model-options=\"{updateOn: 'blur'}\">\t<i ng-click='incrMins()'  ng-show='showButtons && minsFocused' class='lui mp-button top right north arrow icon' ng-class='{disabled: maxed}'></i>\t<i ng-click='decrMins()' ng-show='showButtons && minsFocused' class='lui mp-button bottom right south arrow icon' ng-class='{disabled: mined}'></i></div>")}])}(),function(){"use strict";angular.module("lui").directive("luidPercentage",function(){return{require:["luidPercentage","^ngModel"],controller:"luidPercentageController",scope:{step:"=",format:"@",ngDisabled:"=",placeholder:"@"},restrict:"EA",link:function(e,t,s,i){var l=i[1],i=i[0];if(e.pattern=/^([0-9]+)(\.([0-9]*)?)?$/i,s.format){if("0.XX"!==s.format&&"1.XX"!==s.format&&"XX"!==s.format)return void(l.$render=function(){e.intPct="unsupported format"})}else e.format="0.XX";(e.ngModelCtrl=l).$render=function(){void 0===this.$viewValue?e.intPct=void 0:e.intPct=e.parse(parseFloat(this.$viewValue))},l.$viewChangeListeners.push(function(){e.$eval(s.ngChange)}),i.setupEvents(t.find("input"))},template:"<div class='lui input'><input type='text' ng-disabled='ngDisabled' placeholder='{{placeholder}}' ng-model='intPct' ng-change='updateValue()' ng-blur='formatInputValue()'><span class='unit'>%</span></div>"}}).controller("luidPercentageController",["$scope",function(r){function a(e){t(parseFloat(r.intPct)+e),r.ngModelCtrl.$render()}function t(e){e=void 0===e?void 0:function(e){switch(r.format||"0.XX"){case"XX":return e;case"0.XX":return e/100;case"1.XX":return e/100+1;default:return 0}}(e);r.ngModelCtrl.$setViewValue(e)}this.setupEvents=function(e){function t(){return isNaN(parseInt(r.step))?5:parseInt(r.step)}var s,i,l;i=e,s=t(),i.bind("keydown",function(e){switch(e.which){case 38:e.preventDefault(),a(s),r.$apply();break;case 40:e.preventDefault(),a(-s),r.$apply();break;case 13:e.preventDefault(),r.formatInputValue(),r.$apply()}}),i=e,l=t(),i.bind("mousewheel wheel",function(e){var t,s;this===document.activeElement&&(r.$apply(a((s=(t=(t=e).originalEvent||t).wheelDelta||-t.deltaY,t.detail||0<s?l:-l))),e.preventDefault())})},r.updateValue=function(){t(r.intPct)},r.parse=function(e){switch(r.format||"0.XX"){case"XX":return e;case"0.XX":return Math.round(1e4*e)/100;case"1.XX":return Math.round(1e4*(e-1))/100;default:return 0}},r.formatInputValue=function(){r.ngModelCtrl.$render()}}])}(),function(){"use strict";angular.module("lui").directive("luidTimespan",["moment",function(a){return{require:["luidTimespan","^ngModel"],controller:"luidTimespanController",scope:{step:"=",unit:"=",ngDisabled:"=",placeholder:"@",mode:"=",min:"=",max:"="},restrict:"EA",link:function(s,e,t,i){var l,r=i[1],i=i[0];s.pattern=/^\-?([0-9]+)((h([0-9]{2})?)?(m(in)?)?)?$/i,!t.unit||"h"!=(l=s.$eval(t.unit))&&"hour"!=l&&"hours"!=l||(s.useHours=!0),(s.ngModelCtrl=r).$render=function(){var e,t;s.strDuration="",this.$viewValue&&((t=a.duration(this.$viewValue))<0&&(s.strDuration+="-",t=a.duration(-t)),e=Math.floor(t.asHours()),t=t.minutes(),s.strDuration+=0===e?t+"m":(e<10?"0":"")+e+"h"+(t<10?"0":"")+t)},i.setupEvents(e.find("input")),i.mode=t.mode||"timespan"},template:"<div class='lui timespan input'><input type='text' ng-disabled='ngDisabled' placeholder='{{placeholder}}' ng-pattern='pattern' ng-model='strDuration' ng-change='updateValue()' ng-blur='formatInputValue()' autocorrect='off' spellcheck='false'></div>"}}]).controller("luidTimespanController",["$scope","moment",function(r,a){var i=this;function e(e){function t(e){var t=a.duration(),e=e.split(/m/i);return t.add(parseInt(e[0]),"minutes"),t}switch(!0){case/h/i.test(e):return s=e,i=a.duration(),s=s.split(/h/i),l=0<=parseInt(s[0]),i.add(parseInt(s[0]),"hours"),(s=s[1])&&2<=s.length&&(l?i.add(parseInt(s.substring(0,2)),"minutes"):i.subtract(parseInt(s.substring(0,2)),"minutes")),i;case/m/i.test(e):return t(e);case r.useHours:return l=e,s=a.duration(),l=l.split(/h/i),s.add(parseInt(l[0]),"hours"),s;default:return t(e)}var s,i,l}function n(e){e=a.duration(r.ngModelCtrl.$viewValue).add(e,"minutes");t(e=e.asMilliseconds()<0?a.duration():e),r.ngModelCtrl.$render()}function t(e){if(void 0===e)return r.ngModelCtrl.$setViewValue(void 0);t=t=e,s=r.min?a.duration(r.min):void 0,t=!s||s<=t?t:s,e=!(s=r.max?a.duration(r.max):void 0)||t<=s?t:s,t=e;var t,s,e="timespan"===i.mode?(s="",t.asMilliseconds()<0&&(s+="-",t=a.duration(-t)),s+((0<t.asDays()?Math.floor(t.asDays())+".":"")+(t.hours()<10?"0":"")+t.hours()+":"+(t.minutes()<10?"0":"")+t.minutes())+":00"):t;r.ngModelCtrl.$setViewValue(e)}this.setupEvents=function(e){function t(){return isNaN(parseInt(r.step))?5:parseInt(r.step)}var s,i,l;i=e,s=t(),i.bind("keydown",function(e){switch(e.which){case 38:e.preventDefault(),n(s),r.$apply();break;case 40:e.preventDefault(),n(-s),r.$apply();break;case 13:e.preventDefault(),r.formatInputValue(),r.$apply()}}),i=e,l=t(),i.bind("mousewheel wheel",function(e){var t,s;this===document.activeElement&&(r.$apply(n((s=(t=(t=e).originalEvent||t).wheelDelta||-t.deltaY,t.detail||0<s?l:-l))),e.preventDefault())})},r.updateValue=function(){if(!r.strDuration)return t(void 0);t(e(r.strDuration))},r.formatInputValue=function(){r.ngModelCtrl.$render()}}])}(),function(){"use strict";angular.module("lui").filter("luifPlaceholder",function(){return function(e,t){return e||t}}).filter("luifDefaultCode",function(){return function(e){return t=" ",s="_",((e=e)?e.replace(new RegExp(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),s):"").toUpperCase();var t,s}}).filter("luifStartFrom",function(){return function(e,t){return e.slice(t=+t)}}).filter("luifNumber",["$sce","$filter",function(r,a){return function(e,t,s){var s=null==e||""===e||e!=e?void 0===s?"":s:e,e=a("number")(1.1,1)[1],t=null==t||t!=t?2:t,i=a("number")(s,t),t=(i||a("number")(0,t)).split(e)[1],l=(l=e,void 0===(t=t)?'<span style="opacity:0"></span>':0===parseInt(t)?'<span style="opacity:0">'+l+t+"</span>":"<span>"+l+t+"</span>");if(""===s||!i)return r.trustAsHtml(s+l);t=i.split(e)[0];return r.trustAsHtml(t+l)}}])}(),function(){"use strict";angular.module("lui").filter("luifFriendlyRange",function(){var l={en:{startOnly:"date(dddd, LL) onwards",startOnlyThisYear:"date(dddd, MMMM Do) onwards",endOnly:"until date(dddd, LL)",endOnlyThisYear:"until date(dddd, MMMM Do)",date:"date(LL)",sameDay:"start(dddd, LL)",sameDayThisYear:"start(dddd, MMMM Do)",sameMonth:"start(MMMM Do) - end(Do, YYYY)",sameMonthThisYear:"start(MMMM Do) - end(Do)",sameYear:"start(MMMM Do) - end(LL)",sameYearThisYear:"start(MMMM Do) - end(MMMM Do)",other:"start(LL) - end(LL)"},fr:{startOnly:"à partir du date(dddd LL)",startOnlyThisYear:"à partir du date(dddd Do MMMM)",endOnly:"jusqu'au date(dddd LL)",endOnlyThisYear:"jusqu'au date(dddd Do MMMM)",date:"date(LL)",sameDay:"le start(dddd LL)",sameDayThisYear:"le start(dddd Do MMMM)",sameMonth:"du start(Do) au end(LL)",sameMonthThisYear:"du start(Do) au end(Do MMMM)",sameYear:"du start(Do MMMM) au end(LL)",sameYearThisYear:"du start(Do MMMM) au end(Do MMMM)",other:"du start(LL) au end(LL)"},de:{startOnly:"von date(Do MMMM)",startOnlyThisYear:"von date(LL)",endOnly:"bis date(Do MMMM)",endOnlyThisYear:"bis date(LL)",date:"date(LL)",sameDay:"der start(dddd LL)",sameDayThisYear:"der start(dddd Do MMMM)",sameMonth:"von start(Do) bis end(LL)",sameMonthThisYear:"von start(Do) bis end(Do MMMM)",sameYear:"von start(Do MMMM) bis end(LL)",sameYearThisYear:"von start(Do MMMM) bis end(Do MMMM)",other:"von start(LL) bis end(LL)"},es:{startOnly:"del date(dddd LL)",startOnlyThisYear:"del date(dddd LL)",endOnly:"al date(dddd LL)",endOnlyThisYear:"al date(dddd LL)",date:"date(LL)",sameDay:"el start(dddd LL)",sameDayThisYear:"el start(dddd LL)",sameMonth:"del start(D) al end(LL)",sameMonthThisYear:"del start(D) al end(LL)",sameYear:"del start(LL) al end(LL)",sameYearThisYear:"del start(LL) al end(LL)",other:"del start(LL) al end(LL)"}};function n(e,t,s,i){if(e&&e[t]&&e[t][s])return e[t][s];if(e&&e[t]&&e[t][i])return e[t][i];if(e&&e.en&&e.en[s])return e.en[s];if(e&&e.en&&e.en[i])return e.en[i];e=l;return e[t]&&e[t][s]?e[t][s]:e[t]&&e[t][i]?e[t][i]:e.en&&e.en[s]?e.en[s]:e.en&&e.en[i]?e.en[i]:void 0}return function(e,t,s){if(e){var i,l,r=e.start||e.startsAt||e.startsOn||e.startDate,e=e.end||e.endsAt||e.endsOn||e.endDate;if(!r&&!e)return"";if(r=r?moment(r):void 0,e=e?moment(e):void 0,t&&e.add(-1,"minutes"),r&&e)return a=r.year()===e.year()?r.month()===e.month()?r.date()===e.date()?"sameDay":"sameMonth":"sameYear":"other",moment().year()===r.year()&&moment().year()===e.year()&&(a+="ThisYear"),i=n(s,moment.locale(),a,"other"),l=/(start\((.*?)\))(.*(end\((.*?)\))){0,1}/gi.exec(i),i.replace(l[1],r.format(l[2])).replace(l[4],e.format(l[5]));var a=r?"startOnly":"endOnly",t=r||e;return moment().year()===t.year()&&(a+="ThisYear"),i=n(s,moment.locale(),a,"date"),l=/(date\((.*?)\))/gi.exec(i),i.replace(l[1],t.format(l[2]))}}}).filter("luifMoment",function(){return function(e,t){t=t||"LLL";if(!e)return"";var s=moment(e);return s.isValid()?s.format(t):e}}).filter("luifCalendar",function(){return function(e,t){var s=moment(e);t&&moment(t).isValid()?moment(t):moment();return s.isValid()?s.calendar(t):e}}).filter("luifDuration",["$filter",function(h){return function(e,t,s,i){function l(e){switch(e){case"d":case"day":case"days":return 0;case void 0:case"":case"h":case"hour":case"hours":return 1;case"m":case"min":case"mins":case"minute":case"minutes":return 2;case"s":case"sec":case"second":case"seconds":return 3;case"ms":case"millisec":case"millisecond":case"milliseconds":return 4}}var r=void 0;if(e&&(r=e.asMilliseconds?e.asMilliseconds():e),0===(e=moment.duration(r)).asMilliseconds())return"";for(var a,n=[Math.floor(Math.abs(e.asDays())),Math.abs(e.hours()),Math.abs(e.minutes()),Math.abs(e.seconds()),Math.abs(e.milliseconds())],r=[{index:0,unit:"d",dateConversion:"asDays",expectedPrecision:"h"},{index:1,unit:"h",dateConversion:"asHours",expectedPrecision:"m"},{index:2,unit:"m",dateConversion:"asMinutes",expectedPrecision:"s"},{index:3,unit:"s",dateConversion:"asSeconds",expectedPrecision:"s"},{index:4,unit:"ms",dateConversion:"asMilliseconds",expectedPrecision:"ms"}][l(s)],o=Math.max(r.index,function e(t,s){return 4===s?4:0!==t[s]?s:e(t,s+1)}(n,0)),u=(n[r.index]=Math.abs(0<=e[r.dateConversion]()?Math.floor(e[r.dateConversion]()):Math.ceil(e[r.dateConversion]())),0===r.index&&0===l(i)&&0!==e.asDays()&&(a=function(e){switch(!0){case 0===Math.floor(10*e%10)&&0===Math.floor(100*e%10):return 0;case 0===Math.floor(100*e%10):return 1;case 0===Math.floor(1e3*e%10):return 2;default:return 3}}(s=Math.abs(e.asDays())),n[o=0]=h("number")(s,a)),function e(t,s){return 0===s?0:0!==t[s]?s:e(t,s-1)}(n,l(i||r.expectedPrecision))),d=(s=o,a=u,i=["d ","h","m","s","ms"],"fr"===moment.locale()&&(i[0]="j "),s<=3&&4===a&&(i[3]=".",i[4]="s"),s<=1&&2===a&&(i[2]=""),2===s&&3===a&&(i[3]=""),i),c="",p=o;p<=u;p++)c+=function(e,t,s){switch(t){case s:return e;case 2:case 3:return e<10?"0"+e:e;case 4:return e<10?"00"+e:e<100?"0"+e:e;default:return e}}(n[p],p,o)+d[p];return(c?function(e,t){if(e){if(0<t.asMilliseconds())return"+";if(t.asMilliseconds()<0)return"-"}return""}(t,e):"")+c}}]).filter("luifHumanize",function(){return function(e,t){return t=!!t,moment.duration(e).humanize(t)}})}();